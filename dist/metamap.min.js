(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.MetaMap = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();require("babel/polyfill"),require("core-js"),window.$=window.jQuery=require("jquery"),require("jquery-ui"),require("bootstrap"),window.riot=require("riot"),window._=require("lodash"),window.Promise=require("bluebird");var Auth0=require("./js/app/auth0"),User=require("./js/app/user.js"),Router=require("./js/app/Router.js"),Eventer=require("./js/app/Eventer.js"),PageFactory=require("./js/pages/PageFactory.js"),NProgress=window.NProgress,Config=require("./js/app//Config.js"),ga=require("./js/integrations/google.js"),shims=require("./js/tools/shims.js"),AirbrakeClient=require("airbrake-js"),Integrations=require("./js/app/Integrations"),MetaMap=function(){function e(){_classCallCheck(this,e),this.Config=new Config,this.config=this.Config.config,this.MetaFire=this.Config.MetaFire,this.Eventer=new Eventer(this),this.airbrake=new AirbrakeClient({projectId:114900,projectKey:"dc9611db6f77120ccecd1a273745a5ae"}),this.onReady();var t=this;Promise.onPossiblyUnhandledRejection(function(e){return t.error(e),this})}return _createClass(e,[{key:"onReady",value:function(){var e=this;return this._onReady||(this._onReady=new Promise(function(t,n){e.Config.onReady().then(function(n){e.Auth0=new Auth0(n.auth0),t()})["catch"](function(e){n(e)})})),this._onReady}},{key:"init",value:function(){var e=this;this.onReady().then(function(){e.Auth0.login().then(function(t){e.MetaFire.login().then(function(n){e.User=new User(t,n,e.Eventer,e.MetaFire),e.Integrations=new Integrations(e,e.User),e.User.onReady().then(function(t){e.PageFactory=new PageFactory(e.Eventer,e.MetaFire),e.Router=new Router(e),e.Router.init(),e.Integrations.init()})})})})}},{key:"log",value:function(e){this.debug||this.Integrations.sendEvent(e,"event","log","label"),window.console.info(e)}},{key:"error",value:function(e){window.console.error(e),this.debug||(this.Integrations.sendEvent(e,"exception"),this.airbrake.notify(e))}},{key:"logout",value:function(){this.MetaFire.logout(),this.Auth0.logout()}},{key:"debug",get:function(){return window.location.host.startsWith("localhost")}}]),e}(),mm=new MetaMap;module.exports=mm;
},{"./js/app//Config.js":14,"./js/app/Eventer.js":15,"./js/app/Integrations":17,"./js/app/Router.js":18,"./js/app/auth0":20,"./js/app/user.js":21,"./js/integrations/google.js":45,"./js/pages/PageFactory.js":46,"./js/tools/shims.js":70,"airbrake-js":undefined,"babel/polyfill":"babel/polyfill","bluebird":undefined,"bootstrap":undefined,"core-js":undefined,"jquery":undefined,"jquery-ui":undefined,"lodash":undefined,"riot":"riot"}],2:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_get=function(e,t,r){for(var a=!0;a;){var n=e,o=t,i=r;s=u=c=void 0,a=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(i)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;e=u,t=o,r=i,a=!0}},ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),Action=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),a=0;e>a;a++)r[a]=arguments[a];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r),this._actions={}}return _inherits(t,e),_createClass(t,[{key:"_getAction",value:function(e){var t=this._actions[e];if(!t){var r=null;switch(e){case CONSTANTS.ACTIONS.MAP:r=require("./OpenMap.js");break;case CONSTANTS.ACTIONS.NEW_MAP:r=require("./NewMap.js");break;case CONSTANTS.ACTIONS.COPY_MAP:r=require("./CopyMap.js");break;case CONSTANTS.ACTIONS.DELETE_MAP:r=require("./DeleteMap.js");break;case CONSTANTS.ACTIONS.MY_MAPS:r=require("./MyMaps.js");break;case CONSTANTS.ACTIONS.LOGOUT:r=require("./Logout.js");break;case CONSTANTS.ACTIONS.SHARE_MAP:r=require("./ShareMap");break;case CONSTANTS.ACTIONS.TERMS_AND_CONDITIONS:r=require("./Terms.js");break;case CONSTANTS.ACTIONS.FEEDBACK:r=require("./Feedback");break;default:r=require("./Home.js")}r&&(t=new r(this.metaFire,this.eventer,this.pageFactory),this._actions[e]=t)}return t}},{key:"act",value:function(e){_get(Object.getPrototypeOf(t.prototype),"act",this).call(this);var r=this._getAction(e);if(r){for(var a=arguments.length,n=Array(a>1?a-1:0),o=1;a>o;o++)n[o-1]=arguments[o];return r.act.apply(r,n)}}}]),t}(ActionBase);module.exports=Action;
},{"../constants/constants":26,"./ActionBase.js":3,"./CopyMap.js":4,"./DeleteMap.js":5,"./Feedback":6,"./Home.js":7,"./Logout.js":8,"./MyMaps.js":9,"./NewMap.js":10,"./OpenMap.js":11,"./ShareMap":12,"./Terms.js":13}],3:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),CONSTANTS=require("../constants/constants"),ActionBase=function(){function e(t,n,a){_classCallCheck(this,e),this.metaFire=t,this.eventer=n,this.pageFactory=a,this.metaMap=require("../../MetaMap.js")}return _createClass(e,[{key:"act",value:function(){}},{key:"toggleSidebar",value:function(){this.sidebarOpen?this.openSidebar():this.closeSidebar()}},{key:"openSidebar",value:function(){this.sidebarOpen=!0,this.eventer["do"](CONSTANTS.EVENTS.SIDEBAR_OPEN)}},{key:"closeSidebar",value:function(){this.sidebarOpen=!1,this.eventer["do"](CONSTANTS.EVENTS.SIDEBAR_CLOSE)}}]),e}();module.exports=ActionBase;
},{"../../MetaMap.js":1,"../constants/constants":26}],4:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_get=function(e,t,r){for(var a=!0;a;){var n=e,o=t,i=r;c=s=p=void 0,a=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,o);if(void 0!==c){if("value"in c)return c.value;var p=c.get;return void 0===p?void 0:p.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;e=s,t=o,r=i,a=!0}},ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),CopyMap=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),a=0;e>a;a++)r[a]=arguments[a];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r)}return _inherits(t,e),_createClass(t,[{key:"act",value:function(e){for(var r,a=this,n=arguments.length,o=Array(n>1?n-1:0),i=1;n>i;i++)o[i-1]=arguments[i];return(r=_get(Object.getPrototypeOf(t.prototype),"act",this)).call.apply(r,[this,e].concat(o)),e?(this.metaFire.getData(""+CONSTANTS.ROUTES.MAPS_LIST+e).then(function(t){var r={created_at:""+new Date,owner:{userId:a.metaMap.User.userId,name:a.metaMap.User.displayName,picture:a.metaMap.User.picture},name:a.appendCopy(t.name),shared_with:{admin:{read:!0,write:!0},"*":{read:!1,write:!1}}};a.metaFire.getData(""+CONSTANTS.ROUTES.MAPS_DATA+e).then(function(e){var t=a.metaFire.pushData(r,""+CONSTANTS.ROUTES.MAPS_LIST),n=t.key();a.metaFire.setData(e,""+CONSTANTS.ROUTES.MAPS_DATA+n),a.metaMap.Router.to("map/"+n)})}),!0):new Error("Must have a map in order to copy.")}},{key:"appendCopy",value:function(e){var t=e;if(_.contains(e,"(Copy")){var r=e.split(" "),a=2;if(r.length-r.lastIndexOf("(Copy")<=4){var n=r[r.length-1];n&&(n=n.replace(")",""),a=+n+1,t=r.slice(0,r.length-2).join(" "))}t+=" (Copy "+a+")"}else t+=" (Copy 1)";return t}}]),t}(ActionBase);module.exports=CopyMap;
},{"../constants/constants":26,"./ActionBase.js":3}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function(e,t,r){for(var n=!0;n;){var o=e,a=t,i=r;l=u=c=void 0,n=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,a);if(void 0!==l){if("value"in l)return l.value;var c=l.get;return void 0===c?void 0:c.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;e=u,t=a,r=i,n=!0}},ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),_=require("lodash"),DeleteMap=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),n=0;e>n;n++)r[n]=arguments[n];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r)}return _inherits(t,e),_createClass(t,[{key:"act",value:function(e){for(var r,n=arguments.length,o=Array(n>1?n-1:0),a=1;n>a;a++)o[a-1]=arguments[a];return(r=_get(Object.getPrototypeOf(t.prototype),"act",this)).call.apply(r,[this,e].concat(o)),t.deleteAll([e]),!0}}],[{key:"deleteAll",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?CONSTANTS.PAGES.HOME:arguments[1],r=require("../../MetaMap.js");try{_.each(e,function(e){r.MetaFire.deleteData(""+CONSTANTS.ROUTES.MAPS_DATA+e),r.MetaFire.deleteData(""+CONSTANTS.ROUTES.MAPS_LIST+e)})}catch(n){}finally{r.Router.to(t)}}}]),t}(ActionBase);module.exports=DeleteMap;
},{"../../MetaMap.js":1,"../constants/constants":26,"./ActionBase.js":3,"lodash":undefined}],6:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_get=function(e,t,r){for(var o=!0;o;){var n=e,a=t,i=r;c=s=u=void 0,o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,a);if(void 0!==c){if("value"in c)return c.value;var u=c.get;return void 0===u?void 0:u.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;e=s,t=a,r=i,o=!0}},ActionBase=require("./ActionBase.js"),Feedback=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),o=0;e>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r),this.userSnap=window.UserSnap}return _inherits(t,e),_createClass(t,[{key:"act",value:function(){return _get(Object.getPrototypeOf(t.prototype),"act",this).call(this),this.userSnap.openReportWindow(),!0}}]),t}(ActionBase);module.exports=Feedback;
},{"./ActionBase.js":3}],7:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_get=function(e,t,r){for(var o=!0;o;){var n=e,a=t,i=r;c=s=u=void 0,o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,a);if(void 0!==c){if("value"in c)return c.value;var u=c.get;return void 0===u?void 0:u.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;e=s,t=a,r=i,o=!0}},riot=require("riot"),ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),home=require("../tags/pages/home"),Home=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),o=0;e>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r)}return _inherits(t,e),_createClass(t,[{key:"act",value:function(e){for(var r,o,n=arguments.length,a=Array(n>1?n-1:0),i=1;n>i;i++)a[i-1]=arguments[i];return(r=_get(Object.getPrototypeOf(t.prototype),"act",this)).call.apply(r,[this,e].concat(a)),$("#"+CONSTANTS.ELEMENTS.APP_CONTAINER).empty(),riot.mount(document.getElementById(CONSTANTS.ELEMENTS.APP_CONTAINER),CONSTANTS.TAGS.HOME),(o=this.eventer)["do"].apply(o,[CONSTANTS.EVENTS.PAGE_NAME,{name:"Home"}].concat(a)),this.closeSidebar(),!0}}]),t}(ActionBase);module.exports=Home;
},{"../constants/constants":26,"../tags/pages/home":66,"./ActionBase.js":3,"riot":"riot"}],8:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),_get=function(t,e,r){for(var o=!0;o;){var n=t,a=e,i=r;u=s=c=void 0,o=!1,null===n&&(n=Function.prototype);var u=Object.getOwnPropertyDescriptor(n,a);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;t=s,e=a,r=i,o=!0}},ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),_=require("lodash"),Logout=function(t){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r),this.metaMap=require("../../MetaMap.js")}return _inherits(e,t),_createClass(e,[{key:"act",value:function(t){for(var r,o=arguments.length,n=Array(o>1?o-1:0),a=1;o>a;a++)n[a-1]=arguments[a];return(r=_get(Object.getPrototypeOf(e.prototype),"act",this)).call.apply(r,[this,t].concat(n)),this.metaMap.logout(),!0}}]),e}(ActionBase);module.exports=Logout;
},{"../../MetaMap.js":1,"../constants/constants":26,"./ActionBase.js":3,"lodash":undefined}],9:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),_get=function(t,e,r){for(var o=!0;o;){var n=t,a=e,i=r;c=u=s=void 0,o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,a);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(i)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;t=u,e=a,r=i,o=!0}},riot=require("riot"),ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),home=require("../tags/pages/my-maps"),MyMaps=function(t){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r)}return _inherits(e,t),_createClass(e,[{key:"act",value:function(t){for(var r,o,n,a=arguments.length,i=Array(a>1?a-1:0),c=1;a>c;c++)i[c-1]=arguments[c];return(r=_get(Object.getPrototypeOf(e.prototype),"act",this)).call.apply(r,[this,t].concat(i)),$("#"+CONSTANTS.ELEMENTS.APP_CONTAINER).empty(),riot.mount(document.getElementById(CONSTANTS.ELEMENTS.APP_CONTAINER),CONSTANTS.TAGS.MY_MAPS),(o=this.eventer)["do"].apply(o,[CONSTANTS.PAGES.MY_MAPS,{id:t}].concat(i)),(n=this.eventer)["do"].apply(n,[CONSTANTS.EVENTS.PAGE_NAME,{name:"My Maps"}].concat(i)),this.closeSidebar(),!0}}]),e}(ActionBase);module.exports=MyMaps;
},{"../constants/constants":26,"../tags/pages/my-maps":67,"./ActionBase.js":3,"riot":"riot"}],10:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_get=function(e,t,r){for(var a=!0;a;){var n=e,o=t,i=r;c=u=s=void 0,a=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,o);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(i)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;e=u,t=o,r=i,a=!0}},ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),NewMap=function(e){function t(){_classCallCheck(this,t);for(var e=arguments.length,r=Array(e),a=0;e>a;a++)r[a]=arguments[a];_get(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,r)}return _inherits(t,e),_createClass(t,[{key:"act",value:function(){var e=this;return _get(Object.getPrototypeOf(t.prototype),"act",this).call(this),this.metaFire.getData(""+CONSTANTS.ROUTES.MAPS_NEW_MAP).then(function(t){var r={created_at:""+new Date,owner:{userId:e.metaMap.User.userId,name:e.metaMap.User.displayName,picture:e.metaMap.User.picture},name:"New Untitled Map",shared_with:{admin:{read:!0,write:!0},"*":{read:!1,write:!1}}},a=e.metaFire.pushData(r,""+CONSTANTS.ROUTES.MAPS_LIST),n=a.key();e.metaFire.setData(r,""+CONSTANTS.ROUTES.MAPS_DATA+n),e.metaMap.Router.to("map/"+n)}),!0}}]),t}(ActionBase);module.exports=NewMap;
},{"../constants/constants":26,"./ActionBase.js":3}],11:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_get=function(t,e,r){for(var n=!0;n;){var o=t,a=e,i=r;c=s=u=void 0,n=!1,null===o&&(o=Function.prototype);var c=Object.getOwnPropertyDescriptor(o,a);if(void 0!==c){if("value"in c)return c.value;var u=c.get;return void 0===u?void 0:u.call(i)}var s=Object.getPrototypeOf(o);if(null===s)return void 0;t=s,e=a,r=i,n=!0}},riot=require("riot"),ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),metaCanvas=require("../tags/canvas/meta-canvas.js"),OpenMap=function(t){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r)}return _inherits(e,t),_createClass(e,[{key:"act",value:function(t){for(var r,n=this,o=arguments.length,a=Array(o>1?o-1:0),i=1;o>i;i++)a[i-1]=arguments[i];return(r=_get(Object.getPrototypeOf(e.prototype),"act",this)).call.apply(r,[this,t].concat(a)),$("#"+CONSTANTS.ELEMENTS.APP_CONTAINER).empty(),this.metaFire.getData(""+CONSTANTS.ROUTES.MAPS_LIST+t).then(function(e){if(e){var r,o,i;riot.mount(document.getElementById(CONSTANTS.ELEMENTS.APP_CONTAINER),CONSTANTS.TAGS.META_CANVAS),e.id=t,(r=n.eventer)["do"].apply(r,[CONSTANTS.EVENTS.NAV,"map",e].concat(a)),(o=n.eventer)["do"].apply(o,[CONSTANTS.EVENTS.PAGE_NAME,e].concat(a)),(i=n.eventer)["do"].apply(i,[CONSTANTS.EVENTS.MAP,e].concat(a)),n.openSidebar()}}),!0}}]),e}(ActionBase);module.exports=OpenMap;
},{"../constants/constants":26,"../tags/canvas/meta-canvas.js":47,"./ActionBase.js":3,"riot":"riot"}],12:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),_get=function(t,e,r){for(var o=!0;o;){var n=t,a=e,i=r;c=s=u=void 0,o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,a);if(void 0!==c){if("value"in c)return c.value;var u=c.get;return void 0===u?void 0:u.call(i)}var s=Object.getPrototypeOf(n);if(null===s)return void 0;t=s,e=a,r=i,o=!0}},riot=require("riot"),ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),ShareMap=function(t){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r)}return _inherits(e,t),_createClass(e,[{key:"act",value:function(t){for(var r,o=this,n=arguments.length,a=Array(n>1?n-1:0),i=1;n>i;i++)a[i-1]=arguments[i];return(r=_get(Object.getPrototypeOf(e.prototype),"act",this)).call.apply(r,[this,t].concat(a)),this.metaFire.getData(""+CONSTANTS.ROUTES.MAPS_LIST+t).then(function(e){e&&riot.mount(document.getElementById(CONSTANTS.ELEMENTS.META_MODAL_DIALOG_CONTAINER),CONSTANTS.TAGS.SHARE),o.metaMap.Router.to("map/"+t)}),!0}}]),e}(ActionBase);module.exports=ShareMap;
},{"../constants/constants":26,"./ActionBase.js":3,"riot":"riot"}],13:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),_get=function(t,e,r){for(var o=!0;o;){var n=t,a=e,i=r;c=u=s=void 0,o=!1,null===n&&(n=Function.prototype);var c=Object.getOwnPropertyDescriptor(n,a);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(i)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;t=u,e=a,r=i,o=!0}},riot=require("riot"),ActionBase=require("./ActionBase.js"),CONSTANTS=require("../constants/constants"),terms=require("../tags/pages/terms"),Terms=function(t){function e(){_classCallCheck(this,e);for(var t=arguments.length,r=Array(t),o=0;t>o;o++)r[o]=arguments[o];_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,r)}return _inherits(e,t),_createClass(e,[{key:"act",value:function(t){for(var r,o,n=arguments.length,a=Array(n>1?n-1:0),i=1;n>i;i++)a[i-1]=arguments[i];return(r=_get(Object.getPrototypeOf(e.prototype),"act",this)).call.apply(r,[this,t].concat(a)),$("#"+CONSTANTS.ELEMENTS.APP_CONTAINER).empty(),riot.mount(document.getElementById(CONSTANTS.ELEMENTS.APP_CONTAINER),CONSTANTS.TAGS.TERMS),(o=this.eventer)["do"].apply(o,[CONSTANTS.EVENTS.PAGE_NAME,{name:"Terms and Conditions"}].concat(a)),this.closeSidebar(),!0}}]),e}(ActionBase);module.exports=Terms;
},{"../constants/constants":26,"../tags/pages/terms":68,"./ActionBase.js":3,"riot":"riot"}],14:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),MetaFire=require("./Firebase"),_=require("lodash"),config=function(){var e={CRL_STAGING:{db:"meta-map-staging"}},t={host:window.location.host,site:{}},n=t.host.split("."),i=n[0];switch("www"===i&&(i=n[1]),i=i.split(":")[0],i.toLowerCase()){case"localhost":case"meta-map-staging":default:t.site=e.CRL_STAGING}return t},Config=function(){function e(t){_classCallCheck(this,e),this.tags=t,this.config=config(),this.MetaFire=new MetaFire(this.config)}return _createClass(e,[{key:"onReady",value:function(){var e=this;return this._onReady||(this._onReady=new Promise(function(t,n){e.MetaFire.on("config",function(i){e.MetaFire.on("metamap/canvas",function(a){try{_.extend(e.config.site,i),e.config.canvas=a,document.title=e.config.site.title;var o=document.getElementById("favico");o.setAttribute("href",e.config.site.imageUrl+"favicon.ico"),e.init(),t(e.config.site)}catch(r){n(r)}})})})),this._onReady}},{key:"init",value:function(){return this.onReady()}},{key:"site",get:function(){return"frontend"}}]),e}();module.exports=Config;
},{"./Firebase":16,"lodash":undefined}],15:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),riot=require("riot"),_=require("lodash"),Eventer=function(){function e(t){_classCallCheck(this,e),riot.observable(this),this.events={}}return _createClass(e,[{key:"every",value:function(e,t){var n=this,r=e.split(" ");_.each(r,function(){n.events[e]=t,n.on(e,t)})}},{key:"forget",value:function(e,t){var n=this,r=e.split(" ");_.each(r,function(){t?n.off(e,t):(delete n.events[e],n.off(e))})}},{key:"do",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];var o=e.split(" ");_.each(o,function(){t.trigger.apply(t,[e].concat(r))})}}]),e}();module.exports=Eventer;
},{"lodash":undefined,"riot":"riot"}],16:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Firebase=window.Firebase,Promise=require("bluebird"),localforage=require("localforage"),MetaFire=function(){function t(e){_classCallCheck(this,t),this.config=e,this.fb=new Firebase("https://"+this.config.site.db+".firebaseio.com")}return _createClass(t,[{key:"login",value:function(){var e=this;return this._login||(this._login=new Promise(function(t,n){window.MetaMap.Auth0.getSession().then(function(i){window.MetaMap.Auth0.lock.getClient().getDelegationToken({target:e.config.site.auth0.api,id_token:i.id_token,api_type:"firebase"},function(r,a){r?n(r):(i.firebase_token=a.id_token,e.firebase_token=a.id_token,localforage.setItem("firebase_token",e.firebase_token),e.fb.authWithCustomToken(e.firebase_token,function(i,r){i?(e.metaMap.error(i),n(i)):t(r)}))})})["catch"](function(e){console.log(e)})}),this._onReady=this._login),this._login}},{key:"onReady",value:function(){return this._onReady||(this._onReady=new Promise(function(e,t){e()})),this._onReady}},{key:"getChild",value:function(e){return this.fb.child(e)}},{key:"getData",value:function(t){var n=this;return this.onReady().then(function(){var i=n.fb;return t&&(i=n.getChild(t)),new Promise(function(r,a){i.once("value",function(e){var t=e.val();try{r(t)}catch(i){n.metaMap.error(i)}},function(i){n.error(e,t),a(i)})})})}},{key:"on",value:function(e,t){var n=this,i=arguments.length<=2||void 0===arguments[2]?"value":arguments[2];e&&this.onReady().then(function(){var r=n.getChild(e),a=function o(a){try{if(!a.exists())throw r.off(i,o),new Error("There is no data at "+e);var s=a.val();t(s)}catch(u){r.off(i,o),n.error(u,e)}};r.on(i,a)})}},{key:"off",value:function(e,t,n){var i=this;void 0===t&&(t="value"),e&&this.onReady().then(function(){var r=i.getChild(e);n?r.off(t,n):r.off(t)})}},{key:"setData",value:function(e,t){var n=this,i=this.fb;t&&(i=this.getChild(t));try{return i.set(e,function(e){e&&n.error(e,t)})}catch(r){this.error(r,t)}}},{key:"deleteData",value:function(e){return this.setData(null,e)}},{key:"pushData",value:function(e,t){var n=this,i=this.fb;t&&(i=this.getChild(t));try{return i.push(e,function(e){e&&n.error(e,t)})}catch(r){this.error(r,t)}}},{key:"setDataInTransaction",value:function(e,t,n){var i=this,r=this.fb;t&&(r=this.getChild(t));try{return r.transaction(function(n){try{return e}catch(r){i.error(r,t)}})}catch(a){this.error(a,t)}}},{key:"error",value:function(e,t){e&&this.metaMap.error(e),t&&this.metaMap.error({message:"Permission denied to "+t})}},{key:"logout",value:function(){this._login=null,this._onReady=null,localforage.removeItem("firebase_token"),this.fb.unauth()}},{key:"metaMap",get:function(){return this._metaMap||(this._metaMap=require("../../MetaMap.js")),this._metaMap}}]),t}();module.exports=MetaFire;
},{"../../MetaMap.js":1,"bluebird":undefined,"localforage":undefined}],17:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_=require("lodash"),Twiiter=require("../integrations/Twitter"),Facebook=require("../integrations/Facebook"),Integrations=function(){function e(t,r){_classCallCheck(this,e),this.config=t.config,this.metaMap=t,this.user=r,this._features={google:require("../integrations/Google"),usersnap:require("../integrations/UserSnap"),intercom:require("../integrations/Intercom"),zendesk:require("../integrations/Zendesk"),addthis:require("../integrations/AddThis"),newrelic:require("../integrations/NewRelic")}}return _createClass(e,[{key:"init",value:function(){var e=this;_.each(this._features,function(t,r){if(t)try{var n=e.config.site[r];e[r]=new t(n,e.user),e[r].init(),e[r].setUser()}catch(i){e.metaMap.error(i)}})}},{key:"setUser",value:function(){var e=this;_.each(this._features,function(t,r){if(r)try{e[r].setUser()}catch(n){console.error(n)}})}},{key:"sendEvent",value:function(e){for(var t=this,r=arguments.length,n=Array(r>1?r-1:0),i=1;r>i;i++)n[i-1]=arguments[i];this.metaMap.debug||_.each(this._features,function(r,i){if(i)try{var a;(a=t[i]).sendEvent.apply(a,[e].concat(n))}catch(s){console.log(s)}})}},{key:"updatePath",value:function(){}},{key:"logout",value:function(){var e=this;_.each(this._features,function(t,r){if(r)try{e[r].logout()}catch(n){e.metaMap.error(n)}})}}]),e}();module.exports=Integrations;
},{"../integrations/AddThis":36,"../integrations/Facebook":37,"../integrations/Google":38,"../integrations/Intercom":39,"../integrations/NewRelic":40,"../integrations/Twitter":41,"../integrations/UserSnap":42,"../integrations/Zendesk":43,"lodash":undefined}],18:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),riot=require("riot"),CONSTANTS=require("../constants/constants"),Router=function(){function t(e){_classCallCheck(this,t),this.integrations=e.Integrations,this.user=e.User,this.PageFactory=e.PageFactory,this.eventer=e.Eventer,this.isHidden=!1}return _createClass(t,[{key:"init",value:function(){var t=this;riot.route.start(),riot.route(function(e){for(var r=arguments.length,i=Array(r>3?r-3:0),n=3;r>n;n++)i[n-3]=arguments[n];var a,s=arguments.length<=1||void 0===arguments[1]?"":arguments[1],o=arguments.length<=2||void 0===arguments[2]?"":arguments[2];t.path=t.getPath(e),t.toggleMain(!0,t.path),(a=t.PageFactory).navigate.apply(a,[t.path,s,o].concat(i)),t.eventer["do"]("history",window.location.hash)}),this.to(this.currentPage)}},{key:"getPreviousPage",value:function(){var t=arguments.length<=0||void 0===arguments[0]?2:arguments[0],e="home",r=this.user.history.length;return r>0&&(e=this.getPath(this.user.history[r-t])),e}},{key:"track",value:function(t){this.integrations.updatePath(t)}},{key:"toggleMain",value:function(t,e){this.track(e),t?this.isHidden=!0:this.isHidden=!1}},{key:"getPath",value:function(t){if(t)for(;t.startsWith("!")||t.startsWith("#");)t=t.substr(1);return t}},{key:"to",value:function(t){t=this.getPath(t),t&&(this.toggleMain(!0,t),riot.route(""+t))}},{key:"back",value:function(){var t="home",e=this.user.history.length;if(e>1&&("mymaps"!=this.currentPage||this.currentPage!=this.previousPage)){t=this.previousPage;for(var r=2;!this.isTracked(t)&&this.user.history[r];)r+=1,t=this.getPreviousPage(r)}return this.to(t)}},{key:"isTracked",value:function(t){var e=this.getPath(t);return _.any(this.doNotTrack,function(t){return!e.startsWith(t)})}},{key:"currentPage",get:function(){var t=window.location.hash||"home";if(!this.isTracked(t)){var e=this.user.history.length;e>0&&(t=this.getPath(this.user.history[e-1]))}return t}},{key:"currentPath",get:function(){return this.path}},{key:"previousPage",get:function(){return this.getPreviousPage(2)}},{key:"doNotTrack",get:function(){return this._doNotTrack||(this._doNotTrack=[CONSTANTS.ACTIONS.DELETE_MAP,CONSTANTS.ACTIONS.COPY_MAP,CONSTANTS.ACTIONS.LOGOUT,CONSTANTS.ACTIONS.NEW_MAP,CONSTANTS.ACTIONS.FEEDBACK,CONSTANTS.ACTIONS.SHARE_MAP]),this._doNotTrack}}]),t}();module.exports=Router;
},{"../constants/constants":26,"riot":"riot"}],19:[function(require,module,exports){
"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),localforage=require("localforage"),_=require("lodash"),CONSTANTS=require("../constants/constants"),toBool=function(e){var a=!1;return e===!0||e===!1?a=e:_.contains(["true","yes","1"],e+"".toLowerCase().trim())&&(a=!0),a},Sharing=function(){function e(a){_classCallCheck(this,e),this.user=a,this._metaMap=require("../../MetaMap"),this._fb=this._metaMap.MetaFire}return _createClass(e,[{key:"addShare",value:function(e,a){var t=arguments.length<=2||void 0===arguments[2]?{read:!0,write:!1}:arguments[2];e&&e.id&&a&&a.id&&(this._fb.setData({read:toBool(t.read),write:toBool(t.write),name:t.name,picture:t.picture},CONSTANTS.ROUTES.MAPS_LIST+"/"+e.id+"/shared_with/"+a.id),this._fb.pushData({event:this.user.displayName+" shared a map, "+e.name+", with you!",mapId:e.id,type:CONSTANTS.NOTIFICATION.MAP,time:""+new Date},""+CONSTANTS.ROUTES.NOTIFICATIONS.format(a.id)))}},{key:"removeShare",value:function(e,a){e&&e.id&&a&&a.id&&(this._fb.deleteData(CONSTANTS.ROUTES.MAPS_LIST+"/"+e.id+"/shared_with/"+a.id),this._fb.pushData({event:this.user.displayName+" removed a map, "+e.name+", that was previously shared.",time:""+new Date},""+CONSTANTS.ROUTES.NOTIFICATIONS.format(a.id)))}},{key:"editShare",value:function(e,a){arguments.length<=2||void 0===arguments[2]?{read:!0,write:!1}:arguments[2]}}]),e}();module.exports=Sharing;
},{"../../MetaMap":1,"../constants/constants":26,"localforage":undefined,"lodash":undefined}],20:[function(require,module,exports){
"use strict";function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,o){for(var n=0;n<o.length;n++){var t=o[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(o,n,t){return n&&e(o.prototype,n),t&&e(o,t),o}}(),Auth0Lock=require("auth0-lock"),localforage=require("localforage"),_=require("lodash"),Promise=require("bluebird"),Auth0=function(){function e(o,n){_classCallCheck(this,e),this.config=o,this.metaMap=n,this.lock=new Auth0Lock(o.api,o.app),this.lock.on("loading ready",function(){})}return _createClass(e,[{key:"login",value:function(){var e=this;return this._login||(this._login=new Promise(function(o,n){var t=function(){e.lock.show({closable:!1,loginAfterSignup:!0,authParams:{scope:"openid offline_access"}},function(t,i,l,r,a,c){t?e.onFail(t,n):(e.ctoken=i.ctoken=r,localforage.setItem("ctoken",e.ctoken),e.id_token=i.id_token=l,localforage.setItem("id_token",e.id_token),e.profile=i,localforage.setItem("profile",e.profile),e.refresh_token=i.refresh_token=c,e._getSession=o(i))})};e.getSession().then(function(e){e?o(e):t()})["catch"](function(e){t()})})),this._login}},{key:"linkAccount",value:function(){this.lock.show({callbackURL:location.href.replace(location.hash,""),dict:{signin:{title:"Link with another account"}},authParams:{access_token:this.ctoken}})}},{key:"onFail",value:function(e,o){this.metaMap.error(e),o&&(o(e),this.logout())}},{key:"getSession",value:function(){var e=this;return this.profile?this._getSession=new Promise(function(o,n){o(e.profile)}):this._getSession||(this._getSession=new Promise(function(o,n){return localforage.getItem("id_token").then(function(t){return t?e.lock.getProfile(t,function(i,l){return i?void e.onFail(i,n):(localforage.setItem("id_token",t),localforage.setItem("profile",l),localforage.getItem("ctoken").then(function(o){e.ctoken=o}),e.id_token=l.id_token=t,e.profile=l,o(l))}):n(new Error("No session"))})})),this._getSession}},{key:"logout",value:function(){var e=this;localforage.removeItem("id_token").then(function(){return localforage.removeItem("profile")}).then(function(){e.profile=null,e.ctoken=null,e.id_token=null,e.refresh_token=null,e._login=null,e._getSession=null,window.location.reload()})}}]),e}();module.exports=Auth0;
},{"auth0-lock":undefined,"bluebird":undefined,"localforage":undefined,"lodash":undefined}],21:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),uuid=require("../tools/uuid.js"),Common=require("../tools/Common"),_=require("lodash"),User=function(){function t(e,i,n,r){_classCallCheck(this,t),this.auth=i,this.eventer=n,this.metaFire=r,this.userKey=uuid(),this.onReady(),this.metaMap=require("../../MetaMap")}return _createClass(t,[{key:"onReady",value:function(){var t=this;return this._onReady||!function(){var e=_.once(function(){t.eventer.every("history",function(e){(0==t.history.length||e!=t.history[t.history.length-1])&&(t.history.push(e),t.metaFire.setData(t.history,"users/"+t.auth.uid+"/history"))})});t._onReady=new Promise(function(i,n){t.metaFire.on("users/"+t.auth.uid,function(n){if(n){try{n.history||(n.history=[]),t.profile=n,e()}catch(r){t.metaMap.error(r)}i(n)}})})}(),this._onReady}},{key:"saveUserEditorOptions",value:function(t){({user:{editor_options:JSON.stringify(t)}})}},{key:"_identity",get:function(){var t={};return this.profile&&this.profile.identity&&(t=this.profile.identity),t}},{key:"createdOn",get:function(){if(null==this._createdOn&&this._identity.created_at){var t=new Date(this._identity.created_at);this._createdOn={date:t,ticks:Common.getTicksFromDate(t)}}return this._createdOn||{date:null,ticks:null}}},{key:"displayName",get:function(){var t=this.fullName;return t&&(t=t.split(" ")[0]),!t&&this._identity.nickname&&(t=this._identity.nickname),t}},{key:"fullName",get:function(){var t="";return this._identity.name&&(t=this._identity.name),t}},{key:"email",get:function(){var t="";return this._identity.email&&(t=this._identity.email),t}},{key:"picture",get:function(){var t="";return this._identity.picture&&(t=this._identity.picture),t}},{key:"userId",get:function(){return this.auth.uid}},{key:"isAdmin",get:function(){var t=!1;return this._identity.roles&&(t=1==this._identity.roles.admin),t}},{key:"history",get:function(){return this.profile.history||[]}}]),t}();module.exports=User;
},{"../../MetaMap":1,"../tools/Common":69,"../tools/uuid.js":71,"lodash":undefined}],22:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),jsPlumb=window.jsPlumb,jsPlumbToolkit=window.jsPlumbToolkit,_=require("lodash"),CONSTANTS=require("../constants/constants");require("./layout");var Canvas=function(){function e(t,n){var a=this;_classCallCheck(this,e),this.map=t,this.mapId=n,this.toolkit={},this.metaMap=require("../../MetaMap");var o=this.metaMap.MetaFire.getData(CONSTANTS.ROUTES.MAPS_LIST+"/"+n).then(function(e){a.mapInfo=e}),r=function(){return a.mapInfo&&(a.mapInfo.owner.userId==a.metaMap.User.userId||a.mapInfo.shared_with&&1==a.mapInfo.shared_with[a.metaMap.User.userId].write)},i=this,c=_.throttle(function(){if(r()){var e={data:window.toolkit.exportData(),changed_by:{userId:a.metaMap.User.userId}};a.metaMap.MetaFire.setDataInTransaction(e,"maps/data/"+a.mapId),a.metaMap.Integrations.sendEvent(a.mapId,"event","autosave","autosave")}},500);o.then(function(){jsPlumbToolkit.ready(function(){function e(e){for(var t=e.el,a=e.node,o=t.querySelector(".name"),r=0;r<p.length;r++)h(t,p[r],a);m.draggable(o,{start:function(){m.setZoom(u.getZoom())},stop:function(e){a.data.labelPosition=[parseInt(o.style.left,10),parseInt(o.style.top,10)]}}),jsPlumb.on(o,"dblclick",function(){jsPlumbToolkit.Dialogs.show({id:"dlgText",title:"Enter label:",onOK:function(e){n.updateNode(a,{label:e.text})},data:{text:a.data.label}})})}var t,n=window.toolkit=jsPlumbToolkit.newInstance({beforeStartConnect:function(e,n){return t=n,{type:n}},beforeConnect:function(e,n){var a=!0;if(e==n)a=!1;else switch(t){case"perspective":for(var o=e.getEdges({filter:function(e){return"perspective"==e.data.type}}),r=0;r<o.length;r+=1){var i=o[r];if(i.source==e&&i.target==n||i.target==e&&i.source==n){a=!1;break}}}return a}}),a=function(e){return e=e||"idea",{w:100,h:100,label:"idea",type:e}},o=function(e){return e=e||"proxyPerspective",{w:10,h:10,type:e}},l=document.querySelector(".jtk-demo-main"),s=l.querySelector(".jtk-demo-canvas"),d=function(e){n.clearSelection(),e&&n.setSelection(e)},u=n.render({container:s,elementsDraggable:r(),enablePanButtons:!1,layout:{type:"metamap"},assignPosse:function(e){return e.data.parent||e.id},zoomToFit:!1,view:{nodes:{all:{events:{tap:function(e){d(e.node)},mouseenter:function(e){}}},"default":{parent:"all",template:"tmplNode"},idea:{parent:"default"},"r-thing":{parent:"idea"},proxy:{parent:"all",template:"tmplDragProxy",anchors:["Continuous","Center"]},proxyPerspective:{parent:"proxy"},proxyRelationship:{parent:"proxy",events:{dblclick:function(e){var t=u.mapEventLocation(e.e),o=e.node.getEdges();t.w=.8*o[0].source.data.w,t.h=.8*o[0].source.data.h;for(var r=n.addNode(jsPlumb.extend(a("r-thing"),t)),i=0;i<o.length;i+=1)o[i].source==e.node?n.connect({source:r,target:o[i].target,data:{type:"relationship"}}):o[i].target==e.node&&n.connect({source:o[i].source,target:r,data:{type:"relationshipProxy"}});n.removeNode(e.node)}}}},edges:{all:{events:{tap:function(e){"relationship-overlay"==e.e.target.getAttribute("class"),d(e.edge)}}},"default":{parent:"all",anchors:["Continuous","Continuous"]},connector:{parent:"all",connector:["StateMachine",{margin:1.01,curviness:15}]},relationship:{cssClass:"edge-relationship",parent:"connector",endpoint:"Blank",overlays:[["PlainArrow",{location:1,width:10,length:10,cssClass:"relationship-overlay"}]]},relationshipProxy:{cssClass:"edge-relationship",parent:"connector",endpoint:"Blank"},perspective:{cssClass:"edge-perspective",endpoints:["Blank",["Dot",{radius:5,cssClass:"orange"}]],parent:"connector"},perspectiveProxy:{cssClass:"edge-perspective",endpoints:["Blank",["Dot",{radius:1,cssClass:"orange_proxy"}]],parent:"connector"}}},events:{canvasClick:function(e){d()},canvasDblClick:function(e){var t=u.mapEventLocation(e);t.left=t.left-50,t.top=t.top-50,n.addNode(jsPlumb.extend(a(),t))},nodeAdded:e,edgeAdded:function(e){},relayout:function(){}},dragOptions:{filter:".segment"}});jsPlumbToolkit.Dialogs.initialize({selector:".dlg"});var p=["red","orange","green","blue","text"],f=function(e,t,a,o){console.log(t+" "+e),console.dir(o.data),"dblclick"==t&&n.clearSelection()},g={click:{red:function(e,t){f("R","click",e,t)},green:function(e,t){f("G","click",e,t)},orange:function(e,t){f("O","click",e,t)},blue:function(e,t){f("B","click",e,t)},text:function(e,t){f("T","click",e,t)}},dblclick:{red:function(e,t){f("R","dblclick",e,t),n.addNode(a())},green:function(e,t){f("G","dblclick",e,t);var a=.8*t.data.w,o=.8*t.data.h;t.data.children=t.data.children||[];var r=t.data.label+": Part "+(t.data.children.length+1),i=n.addNode({parent:t.id,w:a,h:o,label:r});t.data.children.push(i.id),u.relayout()},orange:function(e,t){f("O","dblclick",e,t);var r=n.addNode(a()),i=n.addNode(o("proxyPerspective"));n.connect({source:t,target:i,data:{type:"perspectiveProxy"}}),n.connect({source:i,target:r,data:{type:"perspective"}})},blue:function(e,t){f("B","dblclick",e,t);var r=n.addNode(a()),i=n.addNode(o("proxyRelationship"));n.connect({source:t,target:i,data:{type:"relationshipProxy"}}),n.connect({source:i,target:r,data:{type:"relationship"}})},text:function(e,t){f("T","dblclick",e,t);e.querySelector(".name");jsPlumbToolkit.Dialogs.show({id:"dlgText",title:"Enter label:",onOK:function(e){n.updateNode(t,{label:e.text})},data:{text:t.data.label}})}}},h=function(e,t,n){var a=e.querySelector("."+t);jsPlumb.on(a,"click",function(){g.click[t](e,n)}),jsPlumb.on(a,"dblclick",function(){g.dblclick[t](e,n)})},m=jsPlumb.getInstance();i.map&&i.map.data?n.load({type:"json",data:i.map.data}):n.load({url:"data.json"});var v=function(e){return n.filter(function(t){return"Edge"==t.objectType&&t.data.type===e}).getEdgeCount()},b=function(){console.log("There are "+v("relationship")+" relationship edges"),console.log("There are "+v("perspective")+" perspective edges")};n.bind("dataUpdated",function(){b(),c()}),jsPlumb.on("relationshipEdgeDump","click",b()),jsPlumb.on(document,"mousedown",function(e){e.ctrlKey&&u.setMode("select")});var y=function(e){e.eachEdge(function(e,t){console.log(t)}),e.eachNode(function(e,t){var a=function o(e){if(e&&e.data.children)for(var t=0;t<e.data.children.length;t+=1){var a=n.getNode(e.data.children[t]);o(a)}n.removeNode(e)};a(t)}),n.remove(e)};jsPlumb.on(document,"keyup",function(e){var t=n.getSelection();switch(e.keyCode){case 8:t&&e.preventDefault();case 46:y(t)}}),jsPlumb.on(document,"keydown",function(e){switch(e.keyCode){case 46:var t=n.getSelection();y(t)}})})})}return _createClass(e,[{key:"init",value:function(){}}]),e}();module.exports=Canvas;
},{"../../MetaMap":1,"../constants/constants":26,"./layout":23,"lodash":undefined}],23:[function(require,module,exports){
"use strict";!function(){jsPlumbToolkit.Layouts.metamap=function(){jsPlumbToolkit.Layouts.Spring.apply(this,arguments);var t=function(t,i){i=i||{};var a=i.partPadding||50;if(t.data.children)for(var n=t.data.children,s=this.getPosition(t.id),e=this.getSize(t.id),o=[t.id],r="left"===(t.data.partAlign||"right")?0:1,d=s[1]+e[1]+a,h=0;h<n.length;h++)if(n[h]){var u=this.getSize(n[h]),l=s[0]+r*(e[0]-u[0]);this.setPosition(n[h],l,d,!0),o.push(n[h]),d+=u[1]+a}}.bind(this),i=this.end;this.end=function(a,n){for(var s=a.getNodeCount(),e=0;s>e;e++){var o=a.getNodeAt(e);null==o.data.parent&&t(o,n)}i.apply(this,arguments),this.draw()}}}();
},{}],24:[function(require,module,exports){
"use strict";var ACTIONS={MAP:"map",NEW_MAP:"new_map",COPY_MAP:"copy_map",DELETE_MAP:"delete_map",HOME:"home",MY_MAPS:"mymaps",TERMS_AND_CONDITIONS:"terms",LOGOUT:"logout",FEEDBACK:"feedback",SHARE_MAP:"share_map"};Object.freeze(ACTIONS),module.exports=ACTIONS;
},{}],25:[function(require,module,exports){
"use strict";var CANVAS={LEFT:"left",RIGHT:"right"};Object.freeze(CANVAS),module.exports=CANVAS;
},{}],26:[function(require,module,exports){
"use strict";var CONSTANTS={ACTIONS:require("./actions"),CANVAS:require("./canvas"),DSRP:require("./dsrp"),EDIT_STATUS:require("./editStatus"),ELEMENTS:require("./elements"),EVENTS:require("./events"),NOTIFICATION:require("./notification"),PAGES:require("./pages"),ROUTES:require("./routes"),TABS:require("./tabs"),TAGS:require("./tags")};Object.freeze(CONSTANTS),module.exports=CONSTANTS;
},{"./actions":24,"./canvas":25,"./dsrp":27,"./editStatus":28,"./elements":29,"./events":30,"./notification":31,"./pages":32,"./routes":33,"./tabs":34,"./tags":35}],27:[function(require,module,exports){
"use strict";var DSRP={D:"D",S:"S",R:"R",P:"P"};Object.freeze(DSRP),module.exports=DSRP;
},{}],28:[function(require,module,exports){
"use strict";var status={LAST_UPDATED:"",READ_ONLY:"View only",SAVING:"Saving...",SAVE_OK:"All changes saved",SAVE_FAILED:"Changes could not be saved"};Object.freeze(status),module.exports=status;
},{}],29:[function(require,module,exports){
"use strict";var ELEMENTS={APP_CONTAINER:"app-container",META_PROGRESS:"meta_progress",META_PROGRESS_NEXT:"meta_progress_next",META_MODAL_DIALOG_CONTAINER:"meta_modal_dialog_container"};Object.freeze(ELEMENTS),module.exports=ELEMENTS;
},{}],30:[function(require,module,exports){
"use strict";var EVENTS={SIDEBAR_OPEN:"sidebar-open",SIDEBAR_CLOSE:"sidebar-close",SIDEBAR_TOGGLE:"sidebar-toggle",PAGE_NAME:"pageName",NAV:"nav",MAP:"map"};Object.freeze(EVENTS),module.exports=EVENTS;
},{}],31:[function(require,module,exports){
"use strict";var NOTIFICATION={MAP:"map"};Object.freeze(NOTIFICATION),module.exports=NOTIFICATION;
},{}],32:[function(require,module,exports){
"use strict";var ACTIONS=require("./actions.js"),_=require("lodash"),PAGES={MAP:"map",NEW_MAP:"new_map",COPY_MAP:"copy_map",DELETE_MAP:"delete_map",MY_MAPS:"mymaps",TERMS_AND_CONDITIONS:"terms",HOME:"home"};_.extend(),Object.freeze(PAGES),module.exports=PAGES;
},{"./actions.js":24,"lodash":undefined}],33:[function(require,module,exports){
"use strict";var ROUTES={MAPS_LIST:"maps/list/",MAPS_DATA:"maps/data/",MAPS_NEW_MAP:"maps/new-map/",TERMS_AND_CONDITIONS:"metamap/terms-and-conditions/",HOME:"metamap/home/",NOTIFICATIONS:"users/{0}/notifications"};Object.freeze(ROUTES),module.exports=ROUTES;
},{}],34:[function(require,module,exports){
"use strict";var TABS={TAB_ID_PRESENTER:"presenter-tab",TAB_ID_ANALYTICS_MAP:"analytics-tab-map",TAB_ID_ANALYTICS_THING:"analytics-tab-thing",TAB_ID_PERSPECTIVES:"perspectives-tab",TAB_ID_DISTINCTIONS:"distinctions-tab",TAB_ID_ATTACHMENTS:"attachments-tab",TAB_ID_GENERATOR:"generator-tab",TAB_ID_STANDARDS:"standards-tab"};Object.freeze(TABS),module.exports=TABS;
},{}],35:[function(require,module,exports){
"use strict";var TAGS={META_CANVAS:"meta-canvas",HOME:"home",TERMS:"terms",MY_MAPS:"my-maps",SHARE:"share"};Object.freeze(TAGS),module.exports=TAGS;
},{}],36:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_get=function(t,e,r){for(var n=!0;n;){var i=t,o=e,a=r;s=u=c=void 0,n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return void 0;t=u,e=o,r=a,n=!0}},IntegrationsBase=require("./_IntegrationsBase"),AddThis=function(t){function e(t,r){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,r),function(e,r,n){var i,o=e.getElementsByTagName(r)[0],a=window.addthis||{};return e.getElementById(n)?a:(i=e.createElement(r),i.id=n,i.src="//s7.addthis.com/js/300/addthis_widget.js#pubid="+t.pubid,o.parentNode.insertBefore(i,o),a._e=[],a.ready=function(t){a._e.push(t)},a)}(document,"script","add-this-js"),this.addthis=window.addthis}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){_get(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"integration",get:function(){return this.addthis=this.addthis||window.addthis,this.addthis}}]),e}(IntegrationsBase);module.exports=AddThis;
},{"./_IntegrationsBase":44}],37:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),_get=function(e,t,o){for(var n=!0;n;){var i=e,r=t,a=o;c=l=s=void 0,n=!1,null===i&&(i=Function.prototype);var c=Object.getOwnPropertyDescriptor(i,r);if(void 0!==c){if("value"in c)return c.value;var s=c.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=r,o=a,n=!0}},IntegrationsBase=require("./_IntegrationsBase"),Google=require("./google"),Facebook=function(e){function t(e,o){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,o),function(e,t,o){var n,i=e.getElementsByTagName(t)[0];e.getElementById(o)||(n=e.createElement(t),n.id=o,n.src="//connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(n,i))}(document,"script","facebook-jssdk"),this.FB=window.FB}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){_get(Object.getPrototypeOf(t.prototype),"init",this).call(this),this.integration.init({appId:this.config.appid,xfbml:this.config.xfbml,version:this.config.version}),this.integration.Event.subscribe("edge.create",function(e){Google.sendSocial("facebook",e)}),this.integration.Event.subscribe("edge.remove",function(e){Google.sendSocial("facebook",e)}),this.integration.Event.subscribe("message.send",function(e){Google.sendSocial("facebook",e)})}},{key:"integration",get:function(){return this.FB=this.FB||window.FB,this.FB}}]),t}(IntegrationsBase);module.exports=Facebook;
},{"./_IntegrationsBase":44,"./google":45}],38:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function(t,e,n){for(var o=!0;o;){var a=t,i=e,r=n;s=l=c=void 0,o=!1,null===a&&(a=Function.prototype);var s=Object.getOwnPropertyDescriptor(a,i);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(r)}var l=Object.getPrototypeOf(a);if(null===l)return void 0;t=l,e=i,n=r,o=!0}},IntegrationsBase=require("./_IntegrationsBase"),Google=function(t){function e(t,n){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,n),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://apis.google.com/js/platform.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}(),function(t,e,n,o,a){t[o]=t[o]||[],t[o].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=e.getElementsByTagName(n)[0],r=e.createElement(n),s="dataLayer"!=o?"&l="+o:"";r.async=!0,r.src="//www.googletagmanager.com/gtm.js?id="+a+s,i.parentNode.insertBefore(r,i)}(window,document,"script","dataLayer",this.config.tagmanager),function(t,e,n,o,a,i,r){t.GoogleAnalyticsObject=a,t[a]=t[a]||function(){(t[a].q=t[a].q||[]).push(arguments)},t[a].l=1*new Date,i=e.createElement(n),r=e.getElementsByTagName(n)[0],i.async=1,i.src=o,r.parentNode.insertBefore(i,r)}(window,document,"script","//www.google-analytics.com/analytics.js","ga")}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){_get(Object.getPrototypeOf(e.prototype),"init",this).call(this);var t="auto",n=window.location.host;n.startsWith("localhost")&&(t="none"),this.integration("create",this.config.analytics,t),this.integration("send","pageview")}},{key:"setUser",value:function(){_get(Object.getPrototypeOf(e.prototype),"setUser",this).call(this),this.integration("set","userId",this.user.userId)}},{key:"sendEvent",value:function(t,n,o,a){_get(Object.getPrototypeOf(e.prototype),"sendEvent",this).call(this,t,n,o,a),this.integration&&(o&&a?this.integration("send",n,o,a,t):this.integration("send",n,t))}},{key:"updatePath",value:function(t){_get(Object.getPrototypeOf(e.prototype),"updatePath",this).call(this,t),this.integration&&(this.integration("set",{page:t}),this.integration("send","pageview"))}},{key:"integration",get:function(){return this.ga=this.ga||window.ga,this.ga}}],[{key:"sendSocial",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?"send":arguments[2];window.ga&&window.ga("send","social",t,n,e)}},{key:"sendEvent",value:function(t,e,n,o){window.ga&&window.ga("send",t,e,n,o)}}]),e}(IntegrationsBase);module.exports=Google;
},{"./_IntegrationsBase":44}],39:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_get=function(t,e,n){for(var r=!0;r;){var o=t,i=e,a=n;s=u=c=void 0,r=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(a)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;t=u,e=i,n=a,r=!0}},IntegrationsBase=require("./_IntegrationsBase"),Intercom=function(t){function e(t,n){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,n);var r=function s(){s.c(arguments)};r.q=[],r.c=function(t){r.q.push(t)},window.Intercom=r;try{var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://widget.intercom.io/widget/"+t.appid+"}";var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i)}catch(a){}this.intercom=window.Intercom}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){_get(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"setUser",value:function(){_get(Object.getPrototypeOf(e.prototype),"setUser",this).call(this),this.integration("boot",{app_id:this.config.appid,name:this.user.fullName,email:this.user.email,created_at:this.user.createdOn.ticks,user_id:this.user.userId}),this.sendEvent("update")}},{key:"sendEvent",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"update":arguments[0];_get(Object.getPrototypeOf(e.prototype),"sendEvent",this).call(this,t),this.integration("update")}},{key:"updatePath",value:function(t){this.integration("update")}},{key:"logout",value:function(){_get(Object.getPrototypeOf(e.prototype),"logout",this).call(this),this.integration("shutdown")}},{key:"integration",get:function(){return this.intercom=this.intercom||window.Intercom,this.intercom}}]),e}(IntegrationsBase);module.exports=Intercom;
},{"./_IntegrationsBase":44}],40:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),_get=function(t,e,i){for(var o=!0;o;){var n=t,r=e,s=i;a=u=c=void 0,o=!1,null===n&&(n=Function.prototype);var a=Object.getOwnPropertyDescriptor(n,r);if(void 0!==a){if("value"in a)return a.value;var c=a.get;return void 0===c?void 0:c.call(s)}var u=Object.getPrototypeOf(n);if(null===u)return void 0;t=u,e=r,i=s,o=!0}},IntegrationsBase=require("./_IntegrationsBase"),NewRelic=function(t){function e(t,i){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,i),this.NewRelic=window.NREUM}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){_get(Object.getPrototypeOf(e.prototype),"init",this).call(this)}},{key:"setUser",value:function(){_get(Object.getPrototypeOf(e.prototype),"setUser",this).call(this),this.integration&&this.integration.setCustomAttribute&&(this.integration.setCustomAttribute("username",this.user.email),this.integration.setCustomAttribute("acccountID",this.user.userId))}},{key:"sendEvent",value:function(t,i,o,n){_get(Object.getPrototypeOf(e.prototype),"sendEvent",this).call(this,t,i,o,n),this.integration&&this.integration.addToTrace(t)}},{key:"updatePath",value:function(t){_get(Object.getPrototypeOf(e.prototype),"updatePath",this).call(this,t),this.integration&&this.setPageViewName(t,window.location.hostname)}},{key:"integration",get:function(){return this.NewRelic=this.NewRelic||window.NREUM,this.NewRelic}}]),e}(IntegrationsBase);module.exports=NewRelic;
},{"./_IntegrationsBase":44}],41:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function(t,e,n){for(var o=!0;o;){var i=t,r=e,a=n;c=s=l=void 0,o=!1,null===i&&(i=Function.prototype);var c=Object.getOwnPropertyDescriptor(i,r);if(void 0!==c){if("value"in c)return c.value;var l=c.get;return void 0===l?void 0:l.call(a)}var s=Object.getPrototypeOf(i);if(null===s)return void 0;t=s,e=r,n=a,o=!0}},IntegrationsBase=require("./_IntegrationsBase"),Google=require("./google"),Twitter=function(t){function e(t,n){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,n),function(t,e,n){var o=void 0,i=t.getElementsByTagName(e)[0],r=window.twttr||{};return t.getElementById(n)?r:(o=t.createElement(e),o.id=n,o.src="https://platform.twitter.com/widgets.js",i.parentNode.insertBefore(o,i),r._e=[],r.ready=function(t){r._e.push(t)},r)}(document,"script","twitter-wjs")}return _inherits(e,t),_createClass(e,[{key:"init",value:function(){var t=this;_get(Object.getPrototypeOf(e.prototype),"init",this).call(this),this.integration.ready(function(e){e.widgets.load(),e.events.bind("click",t._clickEventToAnalytics),e.events.bind("tweet",t._tweetIntentToAnalytics),e.events.bind("retweet",t._retweetIntentToAnalytics),e.events.bind("favorite",t._favIntentToAnalytics),e.events.bind("follow",t._followIntentToAnalytics)})}},{key:"_followIntentToAnalytics",value:function(t){if(t){var e=t.data.user_id+" ("+t.data.screen_name+")";Google.sendSocial("twitter",e,t.type)}}},{key:"_retweetIntentToAnalytics",value:function(t){if(t){var e=t.data.source_tweet_id;Google.sendSocial("twitter",e,t.type)}}},{key:"_favIntentToAnalytics",value:function(t){this._tweetIntentToAnalytics(t)}},{key:"_tweetIntentToAnalytics",value:function(t){if(t){var e="tweet";Google.sendSocial("twitter",e,t.type)}}},{key:"_clickEventToAnalytics",value:function(t){if(t){var e=t.region;Google.sendSocial("twitter",e,t.type)}}},{key:"integration",get:function(){return this.twttr=this.twttr||window.twttr,this.twttr}}]),e}(IntegrationsBase);module.exports=Twitter;
},{"./_IntegrationsBase":44,"./google":45}],42:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),_get=function(e,t,o){for(var r=!0;r;){var n=e,i=t,a=o;s=l=c=void 0,r=!1,null===n&&(n=Function.prototype);var s=Object.getOwnPropertyDescriptor(n,i);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;e=l,t=i,o=a,r=!0}},IntegrationsBase=require("./_IntegrationsBase"),Google=require("./google"),UserSnap=function(e){function t(e,o){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,o);var r=void 0,n=void 0,i=void 0;if(null==e&&(e={}),r=e.api,r&&!window.location.host.startsWith("localhost")){var a={emailBox:!0,emailBoxValue:o.email,emailRequired:!0,consoleRecorder:!0,mode:"report",shortcut:!0,beforeOpen:function(e){Google.sendEvent("feedback","usersnap","widget",window.location.href)}};window.usersnapconfig=window._usersnapconfig=a,n=document.createElement("script"),n.type="text/javascript",n.async=!0,n.src="//api.usersnap.com/load/"+r+".js",i=document.getElementsByTagName("head")[0],i.appendChild(n)}this.userSnap=window.UserSnap}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){_get(Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"setUser",value:function(){_get(Object.getPrototypeOf(t.prototype),"setUser",this).call(this)}},{key:"integration",get:function(){return this.userSnap=this.userSnap||window.UserSnap,this.userSnap}}]),t}(IntegrationsBase);module.exports=UserSnap;
},{"./_IntegrationsBase":44,"./google":45}],43:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function(e,t,n){for(var o=!0;o;){var i=e,r=t,a=n;s=l=c=void 0,o=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,r);if(void 0!==s){if("value"in s)return s.value;var c=s.get;return void 0===c?void 0:c.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=r,n=a,o=!0}},IntegrationsBase=require("./_IntegrationsBase"),ZenDesk=function(e){function t(e,n){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n);var o={};window.zEmbed||function(e,t){var n=void 0,i=void 0,r=void 0,a=void 0,s=void 0,c=[],l=document.createElement("iframe");window.zEmbed=function(){c.push(arguments)},window.zE=window.zE||window.zEmbed,l.src="javascript:false",l.title="",l.role="presentation",(l.frameElement||l).style.cssText="display: none",r=document.getElementsByTagName("script"),r=r[r.length-1],r.parentNode.insertBefore(l,r),a=l.contentWindow,s=a.document;try{i=s}catch(u){n=document.domain,l.src='javascript:let d=document.open();d.domain="'+n+'";void(0);',i=s}i.open()._l=function(){var i=this.createElement("script");n&&(this.domain=n),i.id="js-iframe-async",i.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=c,this.body.appendChild(i),o.logic=window.zE},i.write('<body onload="document._l();">'),i.close()}("https://assets.zendesk.com/embeddable_framework/main.js",e.site),o.widget=window.zEmbed,o.logic=window.zE}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){_get(Object.getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"setUser",value:function(){var e=this;_get(Object.getPrototypeOf(t.prototype),"setUser",this).call(this),this.integration(function(){e.integration.identify({name:e.user.fullName,email:e.user.email})})}},{key:"integration",get:function(){return window.zE}}]),t}(IntegrationsBase),zenDesk=function(e){return zO};module.exports=ZenDesk;
},{"./_IntegrationsBase":44}],44:[function(require,module,exports){
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),IntegrationsBase=function(){function e(n,t){_classCallCheck(this,e),this.config=n,this.user=t}return _createClass(e,[{key:"init",value:function(){}},{key:"setUser",value:function(){}},{key:"sendEvent",value:function(){}},{key:"updatePath",value:function(){}},{key:"logout",value:function(){}},{key:"integration",get:function(){return{}}}]),e}();module.exports=IntegrationsBase;
},{}],45:[function(require,module,exports){
arguments[4][38][0].apply(exports,arguments)
},{"./_IntegrationsBase":44,"dup":38}],46:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),riot=window.riot,NProgress=window.NProgress,pageBody=require("../tags/page-body.js"),CONSTANTS=require("../constants/constants"),Actions=require("../actions/Action.js"),PageFactory=function(){function e(t,n){_classCallCheck(this,e),this.metaFire=n,this.eventer=t,this.actions=new Actions(n,t,this),this.onReady()}return _createClass(e,[{key:"onReady",value:function(){return this._onReady||(this._onReady=new Promise(function(e,t){$("#"+CONSTANTS.ELEMENTS.META_PROGRESS).remove(),riot.mount("*"),NProgress.configure({parent:"#"+CONSTANTS.ELEMENTS.META_PROGRESS_NEXT}),_.delay(function(){Metronic.init(),Layout.init(),Demo.init(),Index.init(),Tasks.initDashboardWidget(),e()},250)})),this._onReady}},{key:"navigate",value:function(e,t,n){for(var a,i=arguments.length,r=Array(i>3?i-3:0),o=3;i>o;o++)r[o-3]=arguments[o];var s=(a=this.actions).act.apply(a,[e,t,n].concat(r));if(!s){var c;(c=this.eventer)["do"].apply(c,[e,e,{id:t,action:n}].concat(r))}}}]),e}();module.exports=PageFactory;
},{"../actions/Action.js":2,"../constants/constants":26,"../tags/page-body.js":57}],47:[function(require,module,exports){
"use strict";var riot=require("riot"),NProgress=window.NProgress,Canvas=require("../../canvas/canvas");require("./node");var html='\n<div class="portlet light jtk-demo-main" style="padding: 0; ">\n    <div class="jtk-demo-canvas canvas-wide" id="diagram">\n\n    </div>\n</div>\n';module.exports=riot.tag("meta-canvas",html,function(a){var i=this,e=require("../../../MetaMap.js");this.mapId=null,this.canvas=null,this.buildCanvas=function(a){if(i.canvas)a.changed_by!=e.User.userKey&&i.canvas.init();else{$(i.diagram).empty();$(i.diagram).width(),$(i.diagram).height();i.canvas=new Canvas(a,i.mapId),i.canvas.init(),i.update()}NProgress.done()},this.build=function(a){a.id!=i.mapId&&(i.canvas=null,i.mapId&&e.MetaFire.off("maps/data/"+i.mapId),i.mapId=a.id,NProgress.start(),e.MetaFire.on("maps/data/"+a.id,i.buildCanvas),e.Eventer.forget("map",i.build))},e.Eventer.every("map",this.build),this.correctHeight=function(){$(i.diagram).css({height:window.innerHeight-120+"px"})},this.on("update",function(){i.correctHeight()}),$(window).resize(function(){i.correctHeight()})});
},{"../../../MetaMap.js":1,"../../canvas/canvas":22,"./node":48,"riot":"riot"}],48:[function(require,module,exports){
"use strict";var riot=require("riot"),NProgress=window.NProgress,Editor=require("../../canvas/canvas"),html="\n";module.exports=riot.tag("node",html,function(r){});
},{"../../canvas/canvas":22,"riot":"riot"}],49:[function(require,module,exports){
"use strict";var riot=require("riot");module.exports=riot.tag("raw","<span></span>",function(t){var n=this;this.updateContent=function(){this.root.innerHTML=t?t.content||"":""},this.on("update",function(){n.updateContent()}),this.updateContent()});
},{"riot":"riot"}],50:[function(require,module,exports){
"use strict";var riot=require("riot"),moment=require("moment"),Ps=require("perfect-scrollbar"),raw=require("../components/raw"),CONSTANTS=require("../../constants/constants"),html='\n<div class="page-sidebar-wrapper" style="{ getDisplay() }">\n    <div id="chat_shell" class="page-sidebar panel" data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">\n        <div class="panel-heading">\n            <div id="bot_title" class="panel-title chat-welcome">Cortex Man</div>\n        </div>\n        <div id="chat_body" class="panel-body" style="position: absolute;">\n            <ul class="media-list example-chat-messages" id="example-messages">\n                <li each="{ messages }" class="media">\n                    <div class="media-body">\n                        <div class="media">\n                            <a class="pull-{ left: author == \'cortex\', right: author != \'cortex\' }" href="#"><img height="39" width="39" class="media-object img-circle" src="{ picture }"></a>\n                            <div class="media-body bubble">\n                                <raw content="{ message }"></raw>\n                                <small class="text-muted"><br>{ parent.getRelativeTime(time) }</small>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <div class="panel-footer" style="position: fixed; width: 233px; bottom: 26px;">\n            <div class="row">\n                <div class="col-lg-12">\n                    <form id="chat_input_form" onsubmit="{ onSubmit }">\n                        <div class="input-group">\n                            <input id="chat_input" type="text" class="form-control" placeholder="Enter message...">\n                            <span class="input-group-btn">\n                                <button class="btn blue" type="submit">Send</button>\n                            </span>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';riot.tag("chat",html,function(e){var t=this;this.cortexPicture="src/images/cortex-avatar-small.jpg",this.messages=[{message:"Hello, I'm Cortex Man. Ask me anything. Try <code>/help</code> if you get lost.",author:"cortex",picture:this.cortexPicture,time:new Date}];var i=require("../../../MetaMap");this.correctHeight=function(){t.chat_shell.style.height=window.innerHeight-120+"px",t.chat_body.style.height=window.innerHeight-267+"px",Ps.update(t.chat_body)},$(window).resize(function(){t.correctHeight()}),this.on("update",function(){t.correctHeight()}),this.on("mount",function(){Ps.initialize(t.chat_body),t.update()}),this.getDisplay=function(){return t.display?"":"display: none;"},this.getRelativeTime=function(){var e=arguments.length<=0||void 0===arguments[0]?new Date:arguments[0];return moment(e).fromNow()},this.onSubmit=function(e){t.messages.push({message:t.chat_input.value,author:i.User.userName,picture:i.User.picture,time:new Date}),t.messages.push({message:"You asked me "+t.chat_input.value+". That's great!",author:"cortex",picture:t.cortexPicture,time:new Date}),t.chat_input.value="",t.update(),t.chat_body.scrollTop=t.chat_body.scrollHeight,Ps.update(t.chat_body)},this.toggle=function(e){t.display=e,t.update()},i.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_TOGGLE,function(){t.display?i.Eventer["do"](CONSTANTS.EVENTS.SIDEBAR_CLOSE):i.Eventer["do"](CONSTANTS.EVENTS.SIDEBAR_OPEN)}),i.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_CLOSE,function(){t.toggle(!1)}),i.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_OPEN,function(){t.toggle(!0)})});
},{"../../../MetaMap":1,"../../constants/constants":26,"../components/raw":49,"moment":undefined,"perfect-scrollbar":undefined,"riot":"riot"}],51:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("typeahead.js"),require("bootstrap-select");var CONSTANTS=require("../../constants/constants");require("../../tools/shims");var Sharing=require("../../app/Sharing"),html='\n<div id="share_modal" class="modal fade">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <a id="share_public_link"\n                    style="float: right; vertical-align: middle;"\n                    data-clipboard-text="{window.location.host+\'/\'+window.location.pathname+\'/maps/\'+opts.map.id}"\n                    onclick="{ getPublicLink }">\n                        Get sharable link  <i class="fa fa-link"></i></a>\n                <h4 class="modal-title">Share with others</h4>\n            </div>\n            <div class="modal-body">\n                <p>People</p>\n                <form role="form">\n                    <div class="row">\n                        <div id="share_typeahead" class="col-md-8">\n                            <input style="height: 35px;" id="share_input" class="typeahead form-control" type="text" placeholder="Enter names or email addresses..." />\n                        </div>\n                        <div class="col-md-4">\n                            <div class="row">\n                                <div class="col-md-8">\n                                    <select id="share_permission" class="selectpicker">\n                                        <option value="read" data-content="<span><i class=\'fa fa-eye\'></i> Can view</span>">Can view</option>\n                                        <option value="write" data-content="<span><i class=\'fa fa-pencil\'></i> Can edit</span>">Can edit</option>\n                                    </select>\n                                </div>\n                                <div class="col-md-2">\n                                    <a id="share_button" class="btn btn-icon-only green" onclick="{ onShare }" style="display: none;">\n                                        <i class="fa fa-plus"></i>\n                                    </a>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div if="{ opts && opts.map && opts.map.shared_with}" class="row">\n                        <br>\n                        <div class="col-md-12">\n                            <span\n                                class="label label-default"\n                                style="margin-right: 5px;"\n                                if="{i != \'*\' && i != \'admin\'}"\n                                each="{ i, val in opts.map.shared_with}">\n                                <i if="{ val.write }" class="fa fa-pencil"></i>\n                                <i if="{ !val.write }" class="fa fa-eye"></i>\n                                </i>\n                                  { val.name }\n                                <i\n                                    class="fa fa-times-circle"\n                                    style="cursor: pointer;"\n                                    onclick="{ parent.onUnShare }"\n                                    >\n                                </i>\n                            </span>\n                        </div>\n                    </div>\n                </form>\n            </div>\n            <div class="modal-footer">\n                <button type="button" class="btn btn-primary" data-dismiss="modal">Done</button>\n            </div>\n        </div>\n    </div>\n</div>\n';module.exports=riot.tag("share",html,function(e){var a=this,n=require("../../../MetaMap"),i=new Sharing(n.User);this.data=[],this.getPublicLink=function(e,a){},this.onShare=function(e,n){a.opts.map.shared_with[a.suggestion.id]={read:"read"==a.picker.val()||"write"==a.picker.val(),write:"write"==a.picker.val(),name:a.suggestion.name,picture:a.suggestion.picture},i.addShare(a.opts.map,a.suggestion,a.opts.map.shared_with[a.suggestion.id]),a.suggestion=null,a.ta.typeahead("val",""),$(a.share_button).hide()},this.onUnShare=function(e,n){e.item.val.id=e.item.i,delete a.opts.map.shared_with[e.item.i],i.removeShare(a.opts.map,e.item.val)},this.on("update",function(e){e&&_.extend(a.opts,e)}),this.on("mount",function(e,i){$(a.share_modal).modal("show"),a.ta=$("#share_typeahead .typeahead").typeahead({highlight:!0},{source:function(e,i,t){return $.ajax({type:"post",url:"https://api.metamap.co/users/find",data:JSON.stringify({currentUserId:n.User.userId,sessionId:n.Auth0.ctoken,excludedUsers:_.keys(a.opts.map.shared_with),search:e}),contentType:"application/json; charset=utf-8",success:function(e){t(e)},error:function(e){console.log(e)}})},display:function(e){return e.name},templates:{empty:['<div style="padding: 5px 10px; text-align: center;">',"Unable to find any users matching this query","</div>"].join("\n"),suggestion:function(e){return'<div><img alt="'+e.name+'" height="30" width="30" class="img-circle" src="'+e.picture+'"> '+e.name+"</div>"}}}),a.ta.on("typeahead:select",function(e,n){a.suggestion=n,$(a.share_button).show()}),a.ta.on("typeahead:autocomplete",function(e,n){a.suggestion=n,$(a.share_button).show()}),a.picker=$(".selectpicker").selectpicker({width:"auto"})})});
},{"../../../MetaMap":1,"../../app/Sharing":19,"../../constants/constants":26,"../../tools/shims":70,"bootstrap-select":undefined,"jquery":undefined,"riot":"riot","typeahead.js":undefined}],52:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var html='<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">\n            <i class="fa fa-graduation-cap"></i>\n        </a>\n        <ul class="dropdown-menu">\n            <li>\n                <ul class="dropdown-menu-list scroller" style="height: 270px;" data-handle-color="#637283">\n                    <li if="{ help }"\n                        each="{ help }"\n                        onclick="{ parent.onClick }">\n                        <a href="{ link }">\n                            <i class="{ icon }"></i>\n                            <span class="title">{ title }</span>\n                        </a>\n                    </li>\n                </ul>\n            </li>\n        </ul>\n';riot.tag("meta-help",html,function(n){var e=this,t=require("../../../MetaMap");this.onClick=function(n,e){return console.log(n,e),!0},this.help=null,this.on("mount",function(){t.MetaFire.on("metamap/help",function(n){e.help=_.filter(_.sortBy(n,"order"),function(n){var e=1!=n.archive;return e}),e.update()})})});
},{"../../../MetaMap":1,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"riot":"riot"}],53:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var moment=require("moment"),CONSTANTS=require("../../constants/constants");require("../../tools/shims");var html='<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">\n                    <i class="fa fa-bell-o"></i>\n                    <span class="badge badge-success">\n                        { notifications.length }\n                    </span>\n                </a>\n                <ul class="dropdown-menu">\n                    <li class="external">\n                        <h3>\n                            <span class ="bold">{ notifications.length } pending</span> notification{ s: notifications.length == 0 || notifications.length > 1 }\n                        </h3>\n                        <a if="{ allNotifications.length > 1 }" href="javascript:;">view all</a>\n                    </li>\n                    <li>\n                        <ul class="dropdown-menu-list scroller" style="height: 250px;" data-handle-color="#637283">\n                            <li if="{ true != archived }"\n                                each="{ val, i in notifications }"\n                                onclick="{ parent.onClick }">\n                                <a>\n                                    <span if="{ val && val.photo }" class="photo">\n										<img src="{ val.photo }" class="img-circle" alt="">\n                                    </span>\n                                    <span class="subject">\n										<span class="from">{ val.from }</span>\n										<span class="time" style="padding: 0;">{ parent.getTime(val.time) }</span>\n                                    </span>\n                                    <span class="message">{ val.event }</span>\n                                </a>\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n';riot.tag("meta-notifications",html,function(n){var t=this,a=require("../../../MetaMap.js"),i=CONSTANTS.ROUTES.NOTIFICATIONS.format(a.User.userId);this.notifications=[],this.allNotifications=[],this.onClick=function(n,t){var e=n.item.val;switch(a.MetaFire.setData(!0,i+"/"+e.id+"/archive"),e.type){case CONSTANTS.NOTIFICATION.MAP:a.Router.to("map/"+e.mapId)}return!0},this.getTime=function(n){return moment(new Date(n)).fromNow()},this.on("mount",function(){a.MetaFire.getData(i).then(function(n){n||a.MetaFire.pushData({event:"You signed up for MetaMap!",time:""+new Date,archive:!1},i),a.MetaFire.on(CONSTANTS.ROUTES.NOTIFICATIONS.format(a.User.userId),function(n){t.allNotifications=_.map(n,function(n,t){return n.id=t,n}),t.notifications=_.filter(_.sortBy(t.allNotifications,"date"),function(n){var t=1!=n.archive;return t}),t.update()})})})});
},{"../../../MetaMap.js":1,"../../constants/constants":26,"../../tools/shims":70,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"moment":undefined,"riot":"riot"}],54:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var html='<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">\n                    <i class="fa fa-trophy"></i>\n                    <span class="badge badge-success">\n                        { points.length }\n                    </span>\n                </a>\n                <ul class="dropdown-menu">\n                    <li class="external">\n                        <h3>\n                            <span class ="bold">{ points.length } new </span> achievement{ s: points.length == 0 || points.length > 1 }\n                        </h3>\n                        <a href="javascript:;">view all</a>\n                    </li>\n                    <li>\n                        <ul class="dropdown-menu-list scroller" style="height: 250px;" data-handle-color="#637283">\n                            <li if="{ points }"\n                                each="{ points }"\n                                onclick="{ parent.onClick }">\n                                <a href="javascript:;">\n                                    <span class="time">{ time }</span>\n                                    <span class="details">\n                                        <span class="label label-sm label-icon label-success">\n                                            <i class="fa fa-plus"></i>\n                                        </span>\n                                        { event }\n                                    </span>\n                                </a>\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n';riot.tag("meta-points",html,function(n){var s=this,a=require("../../../MetaMap.js");this.points=[],this.onClick=function(n,s){return console.log(n,s),!0},this.on("mount",function(){a.MetaFire.on("users/"+a.User.userId+"/points",function(n){s.points=_.filter(_.sortBy(n,"order"),function(n){var s=1!=n.archive;return s}),s.update()})})});
},{"../../../MetaMap.js":1,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"riot":"riot"}],55:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var html='<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">\n                    <span class="username username-hide-on-mobile">\n                        { username }\n                    </span>\n                    <img if="{ picture }" alt="" height="39" width="39" class="img-circle" src="{ picture }" />\n                </a>\n                <ul class="dropdown-menu dropdown-menu-default">\n                    <li if="{ menu }"\n                        each="{ menu }"\n                        onclick="{ parent.onClick }">\n                        <a href="{ link }">\n                            <i class="{ icon }"></i> { title }\n                        </a>\n                    </li>\n                </ul>\n';riot.tag("meta-user",html,function(n){var e=this,t=require("../../../MetaMap.js");this.menu=[],this.username="",this.picture="",this.logout=function(){t.logout()},this.linkAccount=function(){t.Auth0.linkAccount()},this.onClick=function(n,t){switch(n.item.link){case"#link-social-accounts":return e.linkAccount(),!1;default:return console.log(n,t),!0}},this.on("mount",function(){t.MetaFire.on("metamap/user",function(n){e.username=t.User.displayName,e.picture=t.User.picture,e.menu=_.filter(_.sortBy(n,"order"),function(n){var e=1!=n.archive;return e}),e.update()})})});
},{"../../../MetaMap.js":1,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"riot":"riot"}],56:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var CONSTANTS=require("../constants/constants");require("../tools/shims");var html='\n<div class="page-actions">\n    <div class="btn-group">\n        <button type="button" class="btn red-haze btn-sm dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">\n            <span class="hidden-sm hidden-xs">Actions&nbsp;</span>\n            <i class="fa fa-angle-down"></i>\n        </button>\n        <ul class="dropdown-menu" role="menu">\n            <li each="{ val, i in data }" class="{ start: i == 0, active: i == 0 }">\n                <a if="{ parent.getLinkAllowed(val) }" href="{ parent.getActionLink(val) }">\n                    <i class="{ val.icon }"></i> { val.title }\n                </a>\n            </li>\n            <li class="divider"></li>\n            <li>\n                <a href="#settings">\n                    <i class="fa fa-gear"></i> Settings\n                </a>\n            </li>\n        </ul>\n    </div>\n\n    <span style="padding-left: 5px;">\n        <span if="{ pageName }"\n                id="map_name"\n                data-type="text"\n                data-title="Enter map name"\n                style="vertical-align: middle;">\n            { pageName }\n        </span>\n    </span>\n</div>\n';module.exports=riot.tag("page-actions",html,function(a){var e=this,n=require("../../MetaMap");this.data=[],this.pageName="Home",this.url=n.config.site.db+".firebaseio.com",this.loaded=!1,this.getActionLink=function(a){var n=a.link;return a.url_params&&!function(){var t=[];_.each(a.url_params,function(a){t.push(e[a.name])}),n=a.link.format.call(a.link,t)}(),n},this.getLinkAllowed=function(a){var e=1==a["allowed-on"]["*"];if(!e){var t=n.Router.currentPath;e=1==a["allowed-on"][t]}return e},this.bindTopageName=_.once(function(){e.mapId&&n.MetaFire.on(CONSTANTS.ROUTES.MAPS_LIST+"/"+e.mapId+"/name",function(a){e.pageName=a||"",e.update()}),e.loaded=!0}),n.Eventer.every("pageName",function(a){e.loaded&&$(e.map_name).editable("destroy"),e.mapId&&(n.MetaFire.off(CONSTANTS.ROUTES.MAPS_LIST+"/"+e.mapId+"/name"),a.id&&n.MetaFire.on(CONSTANTS.ROUTES.MAPS_LIST+"/"+a.id+"/name",function(a){e.pageName=a,e.update()})),e.pageName=a.name||"Home",e.mapId=a.id,e.update(),e.mapId&&($(e.map_name).editable({unsavedclass:null}).on("save",function(a,t){n.MetaFire.setData(t.newValue,CONSTANTS.ROUTES.MAPS_LIST+"/"+e.mapId+"/name")}),e.bindTopageName())}),n.MetaFire.on("metamap/actions",function(a){e.data=_.filter(_.sortBy(a,"order"),function(a){var e=1!=a.archive;return e}),e.update()})});
},{"../../MetaMap":1,"../constants/constants":26,"../tools/shims":70,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"riot":"riot"}],57:[function(require,module,exports){
"use strict";var riot=require("riot"),pageHeader=require("./page-header"),pageContainer=require("./page-container"),pageFooter=require("./page-footer"),CONSTANTS=require("../constants/constants"),html='\n<div id="page_body" class="page-header-fixed page-sidebar-closed-hide-logo page-sidebar-closed-hide-logo">\n\n    <div id="meta_page_header"></div>\n\n    <div class="clearfix">\n    </div>\n\n    <div id="meta_page_container"></div>\n\n</div>';module.exports=riot.tag("page-body",html,function(e){var a=this,r=require("../../MetaMap");this.on("mount",function(){riot.mount(a.meta_page_header,"page-header"),riot.mount(a.meta_page_container,"page-container")}),r.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_CLOSE,function(){$(a.page_body).addClass("page-sidebar-reversed")}),r.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_OPEN,function(){$(a.page_body).removeClass("page-sidebar-reversed")})});
},{"../../MetaMap":1,"../constants/constants":26,"./page-container":58,"./page-footer":60,"./page-header":61,"riot":"riot"}],58:[function(require,module,exports){
"use strict";var riot=require("riot"),pageSidebar=require("./page-sidebar"),chat=require("./cortex/chat"),pageContent=require("./page-content"),html='\n<div class="page-container">\n    <div id="meta_page_sidebar"></div>\n    <div id="meta_page_content"></div>\n</div>\n';module.exports=riot.tag("page-container",html,function(e){var t=this;require("../../MetaMap");this.on("mount",function(){riot.mount(t.meta_page_sidebar,"chat"),riot.mount(t.meta_page_content,"page-content")})});
},{"../../MetaMap":1,"./cortex/chat":50,"./page-content":59,"./page-sidebar":64,"riot":"riot"}],59:[function(require,module,exports){
"use strict";var riot=require("riot"),CONSTANTS=require("../constants/constants"),_=require("lodash"),html='\n<div class="page-content-wrapper">\n    <div id="page-content" class="page-content">\n\n        <div class="page-head">\n\n        </div>\n\n\n        <div id="app-container">\n\n        </div>\n    </div>\n</div>\n';module.exports=riot.tag("page-content",html,function(n){var e=this,i=require("../../MetaMap");this.hasSidebar=!0,this.resize=function(){if(e.hasSidebar)$(e["app-container"]).css({width:"100%"});else{var n=window.innerWidth-40+"px";$(e["app-container"]).css({width:n})}},$(window).on("resize",function(){e.resize()}),i.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_OPEN,function(){e.hasSidebar=!0,e.resize()}),i.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_CLOSE,function(){e.hasSidebar=!1,e.resize()})});
},{"../../MetaMap":1,"../constants/constants":26,"lodash":undefined,"riot":"riot"}],60:[function(require,module,exports){
"use strict";var riot=require("riot"),html='\n<div class="page-footer" style="position: fixed; bottom: 0;">\n    <div class="page-footer-inner">\n        <a href="#terms">&copy;2015</a>\n    </div>\n</div>\n';module.exports=riot.tag("page-footer",html,function(e){require("../../MetaMap")});
},{"../../MetaMap":1,"riot":"riot"}],61:[function(require,module,exports){
"use strict";var riot=require("riot"),pageLogo=require("./page-logo.js"),pageActions=require("./page-actions.js"),pageSearch=require("./page-search.js"),pageTopMenu=require("./page-topmenu"),html='\n<div id="header-top" class="page-header navbar navbar-fixed-top">\n    <div id="meta_progress_next" style="overflow: inherit;"></div>\n    <div id="header-content" class="page-header-inner">\n\n        <div id="meta_page_logo"></div>\n        \n        <div id="meta_page_actions"></div>\n        \n        <div id="meta_page_top" class="page-top">\n            <div id="meta_page_search"></div>\n            \n            <div id="meta_page_topmenu"></div>\n        </div>\n\n    </div>\n\n</div>\n';module.exports=riot.tag("page-header",html,function(e){var a=this;require("../../MetaMap");this.on("mount",function(){riot.mount(a.meta_page_logo,"page-logo"),riot.mount(a.meta_page_actions,"page-actions"),riot.mount(a.meta_page_top,"page-search"),riot.mount(a.meta_page_top,"page-topmenu")})});
},{"../../MetaMap":1,"./page-actions.js":56,"./page-logo.js":62,"./page-search.js":63,"./page-topmenu":65,"riot":"riot"}],62:[function(require,module,exports){
"use strict";var riot=require("riot"),CONSTANTS=require("../constants/constants"),html='\n<div class ="page-logo">\n    <a id="meta_logo" href="#home">\n        <img src="assets/img/metamap_cloud.png" alt="logo" class ="logo-default" />\n    </a>\n    <div id="meta_menu_toggle" class="menu-toggler sidebar-toggler" onclick="{ onClick }" style="{ getDisplay(\'menu\') }">\n        <!--DOC: Remove the above "hide" to enable the sidebar toggler button on header-->\n    </div>\n</div>\n<a href="javascript:;" class ="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse">\n</a>\n';module.exports=riot.tag("page-logo",html,function(e){var t=require("../../MetaMap");this.onClick=function(){t.Eventer["do"](CONSTANTS.EVENTS.SIDEBAR_TOGGLE)}});
},{"../../MetaMap":1,"../constants/constants":26,"riot":"riot"}],63:[function(require,module,exports){
"use strict";var riot=require("riot"),html='\n<!-- DOC: Apply "search-form-expanded" right after the "search-form" class to have half expanded search box -->\n<form class="search-form" action="extra_search.html" method="GET">\n    <div class="input-group">\n        <input type="text" class="form-control input-sm" placeholder="Search..." name="query">\n            <span class="input-group-btn">\n                <a href="javascript:;" class="btn submit">\n                    <i class="fa fa-search"></i>\n                </a>\n            </span>\n        </div>\n</form>\n';module.exports=riot.tag("page-search",html,function(a){require("../../MetaMap")});
},{"../../MetaMap":1,"riot":"riot"}],64:[function(require,module,exports){
"use strict";var riot=require("riot"),CONSTANTS=require("../constants/constants"),html='\n<div class="page-sidebar-wrapper" style="{ getDisplay() }">\n    <div class="page-sidebar navbar-collapse collapse">\n        <ul class="page-sidebar-menu " data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200">\n\n            <li if="{ data }" onclick="{ parent.click }" each="{ data }">\n                <a if="{ icon }" href="javascript:;">\n                    <i class="{ icon }" style="color:#{ color };"></i>\n                    <span class="title">{ title }</span>\n                    <span class="{ arrow: menu.length }"></span>\n                </a>\n                <ul if="{ menu && menu.length }" class="sub-menu">\n                    <li each="{ menu }">\n                        <a href="javascript:;">\n                            <i class="{ icon }"></i>\n                            <span class="title">{ title }</span>\n                        </a>\n                    </li>\n                </ul>\n            </li>\n\n        </ul>\n\n    </div>\n</div>\n';module.exports=riot.tag("page-sidebar",html,function(a){var n=this,e=require("../../MetaMap");this.click=function(){console.log("foo")},this.display=!0,this.data=[],e.MetaFire.on("metamap/sidebar",function(a){n.data=_.filter(_.sortBy(a,"order"),function(a){var n=1!=a.archive;return n&&a.menu&&a.menu&&(a.menu=_.filter(_.sortBy(a.menu,"order"),function(a){return 1!=a.archive})),n}),n.update()}),this.getDisplay=function(){return n.display?"":"display: none;"},e.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_CLOSE,function(){n.display=!1,n.update()}),e.Eventer.on(CONSTANTS.EVENTS.SIDEBAR_OPEN,function(){n.display=!0,n.update()})});
},{"../../MetaMap":1,"../constants/constants":26,"riot":"riot"}],65:[function(require,module,exports){
"use strict";var riot=require("riot"),$=require("jquery");require("bootstrap-hover-dropdown");var metaPoints=require("./menu/meta-points.js"),metaHelp=require("./menu/meta-help.js"),metaUser=require("./menu/meta-user.js"),metaNot=require("./menu/meta-notifications.js"),html='\n<div class="top-menu">\n    <ul class="nav navbar-nav pull-right">\n        <li class="separator hide"></li>\n        <li class="dropdown" id="header_dashboard_bar" onclick="{ onClick }">\n            <a class="dropdown-toggle" href="#home">\n                <i class="fa fa-home"></i>\n            </a>\n        </li>\n\n        <li class="separator hide"></li>\n        <li class="dropdown dropdown-extended dropdown-notification dropdown" id="header_notification_bar"></li>\n\n\n\n        <li class="separator hide"></li>\n        <li id="header_help_bar" class="dropdown dropdown-extended dropdown-notification dropdown"></li>\n\n        <li class="separator hide"></li>\n        <li id="header_user_menu" class="dropdown dropdown-user dropdown"></li>\n    </ul>\n</div>\n';module.exports=riot.tag("page-topmenu",html,function(e){var n=this;this.onClick=function(e,n){return console.log(e,n),!0},this.on("mount",function(){riot.mount(n.header_notification_bar,"meta-notifications"),riot.mount(n.header_help_bar,"meta-help"),riot.mount(n.header_user_menu,"meta-user")})});
},{"./menu/meta-help.js":52,"./menu/meta-notifications.js":53,"./menu/meta-points.js":54,"./menu/meta-user.js":55,"bootstrap-hover-dropdown":undefined,"jquery":undefined,"riot":"riot"}],66:[function(require,module,exports){
"use strict";var riot=require("riot"),NProgress=window.NProgress,CONSTANTS=require("../../constants/constants"),html='\n<div class="portlet light">\n				<div class="portlet-body">\n					<div class="row margin-bottom-30">\n						<div if="{ header }" class="col-md-6">\n                            <h1>{ header.title }</h1>\n                            <p>{ header.text }</p>\n							<ul class="list-unstyled margin-top-10 margin-bottom-10">\n								<li each="{ areas }">\n									<i class="{ icon }"></i> <b>{ title }</b> { text }\n								</li>\n							</ul>\n							<!-- Blockquotes -->\n							<blockquote class="hero">\n								<p>{ quote.text }</p>\n								<small>{ quote.by }</small>\n							</blockquote>\n                            <div class="addthis_horizontal_follow_toolbox"></div>\n						</div>\n						<div class ="col-md-6">\n                          <iframe if="{ header.youtubeid }"\n                                id="ytplayer"\n                                type="text/html"\n                                src="https://www.youtube.com/embed/{ header.youtubeid }"\n                                frameborder="0" allowfullscreen\n                                class ="fitvids"\n                                style="height: 327px; width: 100%; display: block; margin-left: auto; margin-right: auto; broder: 0;"\n                            />\n							</iframe>\n						</div>\n					</div>\n                    <div class="headline">\n						<h3>{ userName }{ vision.title }</h3>\n					</div>\n                    <div>\n                        <p>{ vision.text }</p>\n                    </div>\n				</div>\n			</div>\n';module.exports=riot.tag("home",html,function(e){var t=this,i=require("../../../MetaMap");this.areas=[],this.header={},i.MetaFire.on(CONSTANTS.ROUTES.HOME,function(e){t.areas=_.filter(_.sortBy(e.areas,"order"),function(e){var t=1!=e.archive;return t}),t.quote=e.quote,t.header=e.header,t.vision=e.vision,t.userName=i.User.fullName,t.update(),NProgress.done()})});
},{"../../../MetaMap":1,"../../constants/constants":26,"riot":"riot"}],67:[function(require,module,exports){
"use strict";var riot=require("riot"),moment=require("moment"),NProgress=window.NProgress,_=require("lodash"),$=require("jquery");require("datatables"),require("datatables-bootstrap3-plugin"),require("../dialogs/share");var CONSTANTS=require("../../constants/constants"),raw=require("../components/raw"),html='\n<div id="my_maps_page" class="portlet box grey-cascade">\n    <div class="portlet-title">\n        <div class="caption">\n            <i class="fa fa-icon-th-large"></i>MetaMaps\n        </div>\n        <div if="{ menu }" class="actions">\n            <a each="{ menu.buttons }" href="{ link }" onclick="{ parent.onActionClick }" class="btn btn-default btn-sm">\n                <i class="{ icon }"></i> { title }\n            </a>\n            <div class="btn-group">\n                <a class="btn btn-default btn-sm" href="javascript:;" data-toggle="dropdown">\n                    <i class="fa fa-cogs"></i> Tools <i class="fa fa-angle-down"></i>\n                </a>\n                <ul class="dropdown-menu pull-right">\n                    <li each="{ menu.menu }" onclick="{ parent.onMenuClick }">\n                        <a href="{ link }">\n                            <i class="{ icon }"></i> { title }\n                        </a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div class="portlet-body">\n        <ul class="nav nav-tabs portlet-tabs">\n            <li onclick="{ parent.onTabSwitch }" each="{ val, i in tabs }" class="{ active: i == 0 }">\n                <a href="#mymaps_1_{ i }" data-toggle="tab" aria-expanded="{ true: i == 0 }">\n                { val.title }</a>\n            </li>\n        </ul>\n        <div class="table-toolbar">\n\n        </div>\n        <div class="tab-content">\n            <div each="{ val, i in tabs }" class="tab-pane fase in { active: i == 0 }" id="mymaps_1_{ i }">\n                <table class="table table-striped table-bordered table-hover" id="mymaps_table_{ i }">\n                    <thead>\n                        <tr>\n                            <th class="table-checkbox">\n                                <input if="{ val.title == \'My Maps\' }" type="checkbox" class="group-checkable" data-set="#mymaps_table_{ i } .checkboxes"/>\n                            </th>\n                            <th>\n                                Action\n                            </th>\n                            <th>\n                                Name\n                            </th>\n                            <th>\n                                Created On\n                            </th>\n                            <th if="{ val.title == \'My Maps\' }">\n                                Status\n                            </th>\n                            </th>\n                            <th if="{ val.title != \'My Maps\' }">\n                                Owner\n                            </th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr if="{ parent.data && parent.data[i] }" each="{ parent.data[i] }" class="odd gradeX">\n                            <td>\n                                <input if="{ val.title == \'My Maps\' || parent.user.isAdmin }" type="checkbox" class="checkboxes" value="1"/>\n                            </td>\n                            <td>\n                                <button class="btn btn-sm blue filter-submit" onclick="{ parent.onOpen }">Open</button>\n                                <a if="{ val.title == \'My Maps\' }" class="btn btn-sm red" onclick="{ parent.onShare }">Share <i class="fa fa-share"></i></a>\n                                <a if="{ val.title != \'My Maps\' }" class="btn btn-sm red" onclick="{ parent.onCopy }">Copy <i class="fa fa-clone"></i></a>\n                            </td>\n                            <td if="{ editable }" class="meta_editable_{ i }" data-pk="{ id }" data-title="Edit Map Name" style="vertical-align: middle;">{ name }</td>\n                            <td if="{ !editable }" style="vertical-align: middle;">{ name }</td>\n                            <td style="vertical-align: middle;">{ created_at }</td>\n                            <td if="{ val.title == \'My Maps\' }">\n                                <raw content="{ parent.getStatus(this) }"></raw>\n                            </td>\n                            <td if="{ val.title != \'My Maps\' }">\n                                <raw content="{ parent.getOwner(this) }"></raw>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n';module.exports=riot.tag("my-maps",html,function(t){var e=this,a=require("../../../MetaMap.js");this.user=a.User,this.data=null,this.menu=null;var n=[{title:"My Maps",order:0,editable:!0},{title:"Shared with Me",order:1,editable:!1},{title:"Public",order:2,editable:!1}];this.user.isAdmin&&(n.push({title:"All Maps",order:3,editable:!0}),n.push({title:"Templates",order:4,editable:!0})),this.tabs=_.sortBy(n,"order"),this.currentTab="My Maps",this.getStatus=function(t){var e="Private",a="default",n="";return t.shared_with&&(!t.shared_with["*"]||1!=t.shared_with["*"].read&&1!=t.shared_with["*"].write?(_.each(t.shared_with,function(t,e){t.picture&&"*"!=e&&"admin"!=e&&(n+='<span class="label" data-toggle="tooltip" data-placement="bottom" title="'+t.name+'"><img alt="'+t.name+'" height="30" width="30" class="img-circle" src="'+t.picture+'"></span>')}),n&&(n='<span class="">Shared with: </span>'+n)):(e="Public",a="primary")),n=n||'<span class="label label-sm label-'+a+'">'+e+"</span>"},this.getOwner=function(t){var e='<span class="label"><img alt="'+t.owner.name+'" height="30" width="30" class="img-circle" src="'+t.owner.picture+'"></span>';return e},this.onOpen=function(t){a.Router.to("map/"+t.item.id)},this.onShare=function(t){var e={map:t.item},a=riot.mount(document.getElementById(CONSTANTS.ELEMENTS.META_MODAL_DIALOG_CONTAINER),CONSTANTS.TAGS.SHARE)[0];a.update(e)},this.onCopy=function(t){console.log("copy")},this.onTabSwitch=function(t){switch(e.currentTab=t.item.val.title,e.currentTab){case"My Maps":}},this.onActionClick=function(t,e){return!0},this.onMenuClick=function(t,a){if("My Maps"==e.currentTab)switch(t.item.title.toLowerCase()){case"delete":var n=require("../../actions/DeleteMap.js"),i=e.table0.find(".active").find(".mapid"),r=[];_.each(i,function(t){r.push(t.innerHTML)}),n.deleteAll(r,CONSTANTS.PAGES.MY_MAPS);var s=e.table0.find("tbody tr .checkboxes");s.each(function(){$(this).attr("checked",!1),$(this).parents("tr").removeClass("active")}),jQuery.uniform.update(s)}},this.on("update",function(){}),this.on("mount",function(){NProgress.start(),a.MetaFire.on("metamap/mymaps",function(t){t&&(e.menu={buttons:_.sortBy(t.buttons,"order"),menu:_.sortBy(t.menu,"order")},e.update())});var t=function(t,n,i){try{e.data=e.data||{},e.data[t]=n,e["table"+t]&&($(".meta_editable_"+t).editable("destroy"),e["dataTable"+t].destroy()),e.update(),e["table"+t]=$(e["mymaps_table_"+t]),e["dataTable"+t]=e["table"+t].DataTable({columns:[{name:"ChckBx",orderable:!1},{name:"Action",orderable:!1,width:"120px"},{name:"Name",orderable:!0},{name:"Created On",orderable:!0},{name:"Status",orderable:!1}]});var r=e["table"+t].parent().parent().parent().find("#mymaps_"+t+"_table_wrapper");e["table"+t].find(".group-checkable").change(function(){var t=jQuery(this).attr("data-set"),e=jQuery(this).is(":checked");jQuery(t).each(function(){e?($(this).attr("checked",!0),$(this).parents("tr").addClass("active")):($(this).attr("checked",!1),$(this).parents("tr").removeClass("active"))}),jQuery.uniform.update(t)}),e["table"+t].on("change","tbody tr .checkboxes",function(){$(this).parents("tr").toggleClass("active")}),r.find(".dataTables_length select").addClass("form-control input-xsmall input-inline"),$(".meta_editable_"+t).editable({unsavedclass:null}).on("save",function(t,e){if(this.dataset&&this.dataset.pk){var n=this.dataset.pk;a.MetaFire.setData(e.newValue,CONSTANTS.ROUTES.MAPS_LIST+"/"+n+"/name")}return!0}),NProgress.done()}catch(s){NProgress.done(),a.error(s)}};a.MetaFire.getChild(CONSTANTS.ROUTES.MAPS_LIST).on("value",function(n){var i=n.val();_.each(e.tabs,function(n){var r=null;switch(n.title){case"Templates":case"My Maps":r=_.map(i,function(t,e){return t.owner.userId==a.User.userId?(t.editable=!0,t.id=e,t.created_at=moment(new Date(t.created_at)).format("YYYY-MM-DD"),t):void 0});break;case"Shared with Me":r=_.map(i,function(t,e){return t.owner.userId==a.User.userId||!t.shared_with||t.shared_with["*"]&&1==t.shared_with["*"].read&&1==t.shared_with["*"].write||!t.shared_with[a.User.userId]||1!=t.shared_with[a.User.userId].write&&1!=t.shared_with[a.User.userId].read?void 0:(t.editable=1==t.shared_with[a.User.userId].write,t.id=e,t.created_at=moment(new Date(t.created_at)).format("YYYY-MM-DD"),t)});break;case"Public":r=_.map(i,function(t,e){return t.owner.userId!=a.User.userId&&t.shared_with&&t.shared_with["*"]&&(1==t.shared_with["*"].read||1==t.shared_with["*"].write)?(t.editable=1==t.shared_with["*"].write,t.id=e,t.created_at=moment(new Date(t.created_at)).format("YYYY-MM-DD"),t):void 0});break;case"All Maps":e.user.isAdmin&&(r=_.map(i,function(t,e){return t.editable=!0,t.id=e,t.created_at=moment(new Date(t.created_at)).format("YYYY-MM-DD"),t}))}r&&(r=_.filter(r,function(t){return t&&t.id}),t(n.order,r))}),_.delay(function(){$('[data-toggle="tooltip"]').tooltip()},500)})})});
},{"../../../MetaMap.js":1,"../../actions/DeleteMap.js":5,"../../constants/constants":26,"../components/raw":49,"../dialogs/share":51,"datatables":undefined,"datatables-bootstrap3-plugin":undefined,"jquery":undefined,"lodash":undefined,"moment":undefined,"riot":"riot"}],68:[function(require,module,exports){
"use strict";var riot=require("riot"),NProgress=window.NProgress,CONSTANTS=require("../../constants/constants"),html='\n<div class="portlet light">\n				<div class="portlet-body">\n					<div class="row margin-bottom-30">\n						<div if="{ header }" class="col-md-12">\n                            <h1>{ header.title }</h1>\n                            <p>{ header.text }</p>\n						</div>\n					</div>\n                    <div each="{ areas }">\n                        <div class="headline">\n    						<h3>{ title }</h3>\n    					</div>\n                        <div>\n                            <p>{ text }</p>\n                        </div>\n                        <ul class="list-unstyled margin-top-10 margin-bottom-10">\n							<li each="{ items }">\n								<i class="{ icon }"></i> <b>{ title }</b> { text }\n							</li>\n						</ul>\n                    </div>\n				</div>\n			</div>\n';module.exports=riot.tag("terms",html,function(e){var t=this,r=require("../../../MetaMap.js");this.areas=[],this.header={},r.MetaFire.on(CONSTANTS.ROUTES.TERMS_AND_CONDITIONS,function(e){t.areas=_.filter(_.sortBy(e.sections,"order"),function(e){var t=1!=e.archive;return t&&(e.items=_.filter(_.sortBy(e.items,"order"),function(e){var t=1!=e.archive;return t})),t}),t.header=e.header,t.userName=r.User.fullName,t.update(),NProgress.done()})});
},{"../../../MetaMap.js":1,"../../constants/constants":26,"riot":"riot"}],69:[function(require,module,exports){
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),moment=require("moment"),Common=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"splitLines",value:function(e){return e.split(/\n/)}},{key:"getEventTime",value:function(e,n){var t=moment(e,"YYYY-MM-DD HH:mm:ss.SSS"),o=moment(n,"YYYY-MM-DD HH:mm:ss.SSS");return t.from(o)}},{key:"classIf",value:function(e,n){return n?e:""}},{key:"safeApply",value:function(e){e&&"function"==typeof e&&e()}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"getTicksFromDate",value:function(e){var n=null;return e&&e.getTime&&(n=e.getTime()/1e3),n}}]),e}();module.exports=Common;
},{"moment":undefined}],70:[function(require,module,exports){
"use strict";String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(r,e){return"undefined"!=typeof t[e]?t[e]:r})});
},{}],71:[function(require,module,exports){
"use strict";var uuid=function r(){var t,u,o,r;for(o=[],o.length=36,t="0123456789abcdef",u=0;36>u;)o[u]=t.substr(Math.floor(16*Math.random()),1),u+=1;return o[14]="4",o[19]=t.substr(3&o[19]|8,1),o[8]=o[13]=o[18]=o[23]="-",r=o.join("")};module.exports=uuid;
},{}]},{},[1])(1)
});


//# sourceMappingURL=metamap.map.json